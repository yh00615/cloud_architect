---
title: "AWS CloudFormation μ¤νƒ μƒλ…μ£ΌκΈ° κ΄€λ¦¬"
week: 6
session: 1
awsServices:
  - AWS CloudFormation
learningObjectives:
  - Infrastructure as Codeμ κ°λ…κ³Ό μ΄μ μ„ μ΄ν•΄ν•  μ μμµλ‹λ‹¤
  - AWS CloudFormationμ λ™μ‘ μ›λ¦¬μ™€ μ£Όμ” κµ¬μ„± μ”μ†λ¥Ό μ„¤λ…ν•  μ μμµλ‹λ‹¤
  - ν…ν”λ¦Ώμ μ£Όμ” μ„Ήμ…(Resources, Parameters, Outputs)κ³Ό μ—­ν• μ„ μ΄ν•΄ν•  μ μμµλ‹λ‹¤
  - YAML λ¬Έλ²•μ„ μ‚¬μ©ν•μ—¬ AWS CloudFormation ν…ν”λ¦Ώμ„ μ‘μ„±ν•  μ μμµλ‹λ‹¤
  - Intrinsic Functionsλ¥Ό ν™μ©ν•μ—¬ λ™μ  ν…ν”λ¦Ώμ„ κµ¬μ„±ν•  μ μμµλ‹λ‹¤
  - λ³€κ²½ μ„ΈνΈλ¥Ό μ‚¬μ©ν•μ—¬ λ³€κ²½ μ‚¬ν•­μ„ λ―Έλ¦¬ ν™•μΈν•  μ μμµλ‹λ‹¤
  - λ“λ¦¬ν”„νΈ νƒμ§€λ΅ μ‹¤μ  λ¦¬μ†μ¤μ™€ ν…ν”λ¦Ώ κ°„ μ°¨μ΄λ¥Ό νμ•…ν•  μ μμµλ‹λ‹¤
prerequisites:
  - AWS κΈ°λ³Έ μ„λΉ„μ¤ μ΄ν•΄ (Amazon VPC, Amazon EC2, Amazon S3 λ“±)
  - YAML λλ” JSON κΈ°λ³Έ λ¬Έλ²• μ΄ν•΄
---

μ΄ λ°λ¨μ—μ„λ” AWS CloudFormation μ¤νƒμ μ „μ²΄ μƒλ…μ£ΌκΈ°λ¥Ό μ‹μ—°ν•©λ‹λ‹¤. κ°„λ‹¨ν• Amazon S3 λ²„ν‚· μ¤νƒμ„ μƒμ„±(CREATE)ν•κ³ , λ³€κ²½ μ„ΈνΈλ¥Ό ν†µν•΄ μ•μ „ν•κ² μ—…λ°μ΄νΈ(UPDATE)ν•λ©°, λ“λ¦¬ν”„νΈ νƒμ§€λ΅ μλ™ λ³€κ²½μ„ κ°μ§€ν• ν›„ μ¤νƒμ„ μ‚­μ (DELETE)ν•λ” μ „μ²΄ ν”„λ΅μ„Έμ¤λ¥Ό κ²½ν—ν•©λ‹λ‹¤. κ° λ‹¨κ³„μ—μ„ μ¤νƒ μƒνƒ λ³€ν™”λ¥Ό κ΄€μ°°ν•κ³  AWS CloudFormationμ΄ λ¦¬μ†μ¤λ¥Ό μ–΄λ–»κ² κ΄€λ¦¬ν•λ”μ§€ μ΄ν•΄ν•©λ‹λ‹¤.

**μ£Όμ” νƒμ¤ν¬:**
- νƒμ¤ν¬ 1: μ¤νƒ μƒμ„± (CREATE) - Amazon S3 λ²„ν‚· μ¤νƒ
- νƒμ¤ν¬ 2: μ¤νƒ μ—…λ°μ΄νΈ (UPDATE) - λ³€κ²½ μ„ΈνΈλ΅ μ•μ „ν• μ—…λ°μ΄νΈ
- νƒμ¤ν¬ 3: λ“λ¦¬ν”„νΈ νƒμ§€ - μλ™ λ³€κ²½ κ°μ§€
- νƒμ¤ν¬ 4: μ¤νƒ μ‚­μ  (DELETE) - μƒλ…μ£ΌκΈ° μ™„λ£

> [!DOWNLOAD]
> [week6-1-cloudformation-demo.zip](/files/week6/week6-1-cloudformation-demo.zip)
> - `simple-s3-template.yaml` - κΈ°λ³Έ Amazon S3 λ²„ν‚· ν…ν”λ¦Ώ (νƒμ¤ν¬ 1μ—μ„ μ¤νƒ μƒμ„±)
> - `s3-with-tags.yaml` - νƒκ·Έκ°€ μ¶”κ°€λ Amazon S3 λ²„ν‚· ν…ν”λ¦Ώ (νƒμ¤ν¬ 2μ—μ„ λ³€κ²½ μ„ΈνΈ μƒμ„±)
> - `README.md` - ν…ν”λ¦Ώ μ„¤λ… λ° νΈλ¬λΈ”μν… κ°€μ΄λ“
> 
> **κ΄€λ ¨ νƒμ¤ν¬:**
> 
> - νƒμ¤ν¬ 1: Amazon S3 μ¤νƒ μƒμ„± (simple-s3-template.yaml μ‚¬μ©)
> - νƒμ¤ν¬ 2: λ³€κ²½ μ„ΈνΈ μƒμ„± λ° μ‹¤ν–‰ (s3-with-tags.yamlλ΅ μ—…λ°μ΄νΈ)
> - νƒμ¤ν¬ 3: λ“λ¦¬ν”„νΈ νƒμ§€ (μλ™ λ³€κ²½ κ°μ§€)

> [!NOTE]
> μ΄ λ°λ¨λ” λΉ„μ©μ΄ κ±°μ λ°μƒν•μ§€ μ•μµλ‹λ‹¤. Amazon S3 λ²„ν‚· μμ²΄λ” λ¬΄λ£μ΄λ©°, λ°μ΄ν„°λ¥Ό μ €μ¥ν•μ§€ μ•μΌλ―€λ΅ μ¤ν† λ¦¬μ§€ λΉ„μ©λ„ λ°μƒν•μ§€ μ•μµλ‹λ‹¤.

## νƒμ¤ν¬ 1: μ¤νƒ μƒμ„± (CREATE) - Amazon S3 λ²„ν‚· μ¤νƒ

μ΄ νƒμ¤ν¬μ—μ„λ” κ°„λ‹¨ν• Amazon S3 λ²„ν‚· ν…ν”λ¦Ώμ„ μ‚¬μ©ν•μ—¬ AWS CloudFormation μ¤νƒμ„ μƒμ„±ν•©λ‹λ‹¤. μ¤νƒ μƒμ„± κ³Όμ •μ—μ„ μƒνƒ λ³€ν™”(CREATE_IN_PROGRESS β†’ CREATE_COMPLETE)λ¥Ό κ΄€μ°°ν•κ³ , μƒμ„±λ λ¦¬μ†μ¤λ¥Ό ν™•μΈν•©λ‹λ‹¤.

> [!CONCEPT] μ¤νƒ μƒμ„± ν”„λ΅μ„Έμ¤
> AWS CloudFormation μ¤νƒ μƒμ„±μ€ λ‹¤μ λ‹¨κ³„λ΅ μ§„ν–‰λ©λ‹λ‹¤:
> 
> - **ν…ν”λ¦Ώ κ²€μ¦**: AWS CloudFormationμ΄ ν…ν”λ¦Ώ λ¬Έλ²•μ„ ν™•μΈν•©λ‹λ‹¤
> - **λ¦¬μ†μ¤ μƒμ„±**: AWS APIλ¥Ό νΈμ¶ν•μ—¬ Amazon S3 λ²„ν‚·μ„ μƒμ„±ν•©λ‹λ‹¤
> - **μƒνƒ μ¶”μ **: κ° λ¦¬μ†μ¤μ μƒμ„± μƒνƒλ¥Ό λ¨λ‹ν„°λ§ν•©λ‹λ‹¤
> - **μ¶λ ¥κ°’ μƒμ„±**: Outputs μ„Ήμ…μ— μ •μλ κ°’μ„ ν‘μ‹ν•©λ‹λ‹¤
> - **μ™„λ£**: λ¨λ“  λ¦¬μ†μ¤κ°€ μ„±κ³µμ μΌλ΅ μƒμ„±λλ©΄ μ¤νƒ μƒνƒκ°€ CREATE_COMPLETEλ΅ λ³€κ²½λ©λ‹λ‹¤

μ¤νƒ μƒμ„± κ³Όμ •μ—μ„ λ‹¤μ–‘ν• μƒνƒ λ³€ν™”λ¥Ό ν™•μΈν•  μ μμµλ‹λ‹¤.

> [!NOTE]
> **μƒνƒ λ³€ν™”:**
> 
> - **CREATE_IN_PROGRESS** (μ£Όν™©μƒ‰): λ¦¬μ†μ¤ μƒμ„± μ¤‘
> - **CREATE_COMPLETE** (μ΄λ΅μƒ‰): λ¨λ“  λ¦¬μ†μ¤ μƒμ„± μ™„λ£
> - **CREATE_FAILED** (λΉ¨κ°„μƒ‰): μƒμ„± μ‹¤ν¨ (μλ™ λ΅¤λ°±)
> - **ROLLBACK_IN_PROGRESS**: μ‹¤ν¨ν• λ¦¬μ†μ¤ μ‚­μ  μ¤‘
> - **ROLLBACK_COMPLETE**: λ΅¤λ°± μ™„λ£

### μƒμ„Έ λ‹¨κ³„

1. λ‹¤μ΄λ΅λ“ν• `week6-1-cloudformation-demo.zip` νμΌμ μ••μ¶•μ„ ν•΄μ ν•©λ‹λ‹¤.
2. `simple-s3-template.yaml` νμΌμ„ ν…μ¤νΈ μ—λ””ν„°λ΅ μ—½λ‹λ‹¤.
3. ν…ν”λ¦Ώ κµ¬μ΅°λ¥Ό ν™•μΈν•©λ‹λ‹¤:

```yaml
AWSTemplateFormatVersion: '2010-09-09'
Description: 'Simple Amazon S3 bucket for AWS CloudFormation demo'

Parameters:
  BucketPrefix:
    Type: String
    Default: cfn-demo-bucket
    Description: Amazon S3 bucket name prefix

Resources:
  DemoBucket:
    Type: AWS::Amazon S3::Bucket
    Properties:
      BucketName: !Sub '${BucketPrefix}-${AWS::AccountId}'
      Tags:
        - Key: Purpose
          Value: AWS CloudFormation Demo

Outputs:
  BucketName:
    Description: Name of the Amazon S3 bucket
    Value: !Ref DemoBucket
```

4. AWS Management Consoleμ— λ΅κ·ΈμΈν• ν›„ μƒλ‹¨ κ²€μƒ‰μ°½μ—μ„ `AWS CloudFormation`μ„ κ²€μƒ‰ν•κ³  μ„ νƒν•©λ‹λ‹¤.
5. [[Create stack]] λ“λ΅­λ‹¤μ΄μ„ ν΄λ¦­ν• ν›„ **With new resources (standard)**λ¥Ό μ„ νƒν•©λ‹λ‹¤.
6. **Prerequisite - Prepare template**μ—μ„ `Choose an existing template`λ¥Ό μ„ νƒν•©λ‹λ‹¤.
7. **Specify template**μ—μ„ `Upload a template file`μ„ μ„ νƒν•©λ‹λ‹¤.
8. [[Choose file]] λ²„νΌμ„ ν΄λ¦­ν• ν›„ `simple-s3-template.yaml` νμΌμ„ μ„ νƒν•©λ‹λ‹¤.
9. [[Next]] λ²„νΌμ„ ν΄λ¦­ν•©λ‹λ‹¤.
10. **Stack name**μ— `demo-s3-stack`μ„ μ…λ ¥ν•©λ‹λ‹¤.
11. **Parameters** μ„Ήμ…μ—μ„ **BucketPrefix** κ°’μ„ ν™•μΈν•©λ‹λ‹¤ (κΈ°λ³Έκ°’ `cfn-demo-bucket` μ‚¬μ©).
12. [[Next]] λ²„νΌμ„ ν΄λ¦­ν•©λ‹λ‹¤.
13. **Configure stack options** νμ΄μ§€μ—μ„ μ•„λλ΅ μ¤ν¬λ΅¤ν•μ—¬ **Tags** μ„Ήμ…μ„ μ°Ύμµλ‹λ‹¤.
14. [[Add new tag]] λ²„νΌμ„ ν΄λ¦­ν• ν›„ λ‹¤μ νƒκ·Έλ¥Ό μ¶”κ°€ν•©λ‹λ‹¤:

| Key | Value |
|-----|-------|
| `Project` | `AWS-Lab` |
| `Week` | `6-1` |
| `CreatedBy` | `Student` |

15. **Capabilities** μ„Ήμ…μ—μ„ `I acknowledge that AWS CloudFormation might create AWS IAM resources`λ¥Ό μ²΄ν¬ν•©λ‹λ‹¤.
16. [[Next]] λ²„νΌμ„ ν΄λ¦­ν•©λ‹λ‹¤.
17. **Review** νμ΄μ§€μ—μ„ μ„¤μ •μ„ ν™•μΈν•©λ‹λ‹¤.
18. [[Submit]] λ²„νΌμ„ ν΄λ¦­ν•©λ‹λ‹¤.
18. μ¤νƒ μƒμ„±μ΄ μ‹μ‘λ©λ‹λ‹¤. μƒνƒκ°€ "CREATE_IN_PROGRESS"λ΅ ν‘μ‹λ©λ‹λ‹¤.

> [!NOTE]
> μ¤νƒ μƒμ„±μ— 1-2λ¶„μ΄ μ†μ”λ©λ‹λ‹¤. **Events** νƒ­μ—μ„ μƒμ„± κ³Όμ •μ„ ν™•μΈν•  μ μμµλ‹λ‹¤.
> AWS CloudFormationμ΄ Amazon S3 λ²„ν‚·μ„ μƒμ„±ν•λ” κ³Όμ •μ„ μ‹¤μ‹κ°„μΌλ΅ κ΄€μ°°ν•©λ‹λ‹¤.
> 
> **μ¤νƒ νƒκ·Έ μλ™ μ „ν**: μ¤νƒμ— μ¶”κ°€ν• νƒκ·Έ(`Project`, `Week`, `CreatedBy`)λ” μ¤νƒμ΄ μƒμ„±ν•λ” λ¨λ“  λ¦¬μ†μ¤(Amazon S3 λ²„ν‚·)μ— μλ™μΌλ΅ μ „νλ©λ‹λ‹¤.

19. μƒνƒκ°€ "**CREATE_COMPLETE**"λ΅ λ³€κ²½λ  λ•κΉμ§€ κΈ°λ‹¤λ¦½λ‹λ‹¤.
20. **Outputs** νƒ­μ„ μ„ νƒν•©λ‹λ‹¤.
21. **BucketName** κ°’μ„ ν™•μΈν•©λ‹λ‹¤ (μ: `cfn-demo-bucket-123456789012`).
22. **Resources** νƒ­μ„ μ„ νƒν•©λ‹λ‹¤.
23. **DemoBucket** λ¦¬μ†μ¤μ **Physical ID**λ¥Ό ν΄λ¦­ν•©λ‹λ‹¤.
24. Amazon S3 μ½μ†”μ—μ„ μƒμ„±λ λ²„ν‚·μ„ ν™•μΈν•©λ‹λ‹¤.

β… **νƒμ¤ν¬ μ™„λ£**: μ¤νƒ μƒμ„±(CREATE) μƒλ…μ£ΌκΈ°λ¥Ό μ‹μ—°ν–μµλ‹λ‹¤.

## νƒμ¤ν¬ 2: μ¤νƒ μ—…λ°μ΄νΈ (UPDATE) - λ³€κ²½ μ„ΈνΈλ΅ μ•μ „ν• μ—…λ°μ΄νΈ

μ΄ νƒμ¤ν¬μ—μ„λ” μ¤νƒ μ—…λ°μ΄νΈ μƒλ…μ£ΌκΈ°λ¥Ό μ‹μ—°ν•©λ‹λ‹¤. νƒκ·Έκ°€ μ¶”κ°€λ ν…ν”λ¦ΏμΌλ΅ μ—…λ°μ΄νΈν•λ©΄μ„ μƒνƒ λ³€ν™”(UPDATE_IN_PROGRESS β†’ UPDATE_COMPLETE)λ¥Ό κ΄€μ°°ν•κ³ , Change set previewλ΅ λ³€κ²½ μ‚¬ν•­μ„ λ―Έλ¦¬ ν™•μΈν•©λ‹λ‹¤.

> [!CONCEPT] μ¤νƒ μ—…λ°μ΄νΈ ν”„λ΅μ„Έμ¤
> AWS CloudFormation μ¤νƒ μ—…λ°μ΄νΈλ” λ‹¤μ λ‹¨κ³„λ΅ μ§„ν–‰λ©λ‹λ‹¤:
> 
> - **λ³€κ²½ μ‚¬ν•­ λ¶„μ„**: μƒ ν…ν”λ¦Ώκ³Ό κΈ°μ΅΄ ν…ν”λ¦Ώμ„ λΉ„κµν•©λ‹λ‹¤
> - **Change set preview**: μ–΄λ–¤ λ¦¬μ†μ¤κ°€ μ–΄λ–»κ² λ³€κ²½λλ”μ§€ λ―Έλ¦¬ λ³΄μ—¬μ¤λ‹λ‹¤
> - **λ¦¬μ†μ¤ μ—…λ°μ΄νΈ**: AWS APIλ¥Ό νΈμ¶ν•μ—¬ λ¦¬μ†μ¤λ¥Ό μμ •ν•©λ‹λ‹¤
> - **μƒνƒ μ¶”μ **: κ° λ¦¬μ†μ¤μ μ—…λ°μ΄νΈ μƒνƒλ¥Ό λ¨λ‹ν„°λ§ν•©λ‹λ‹¤
> - **μ™„λ£**: λ¨λ“  λ¦¬μ†μ¤κ°€ μ„±κ³µμ μΌλ΅ μ—…λ°μ΄νΈλλ©΄ μ¤νƒ μƒνƒκ°€ UPDATE_COMPLETEλ΅ λ³€κ²½λ©λ‹λ‹¤
> 
> **μƒνƒ λ³€ν™”:**
> 
> - **UPDATE_IN_PROGRESS** (μ£Όν™©μƒ‰): λ¦¬μ†μ¤ μ—…λ°μ΄νΈ μ¤‘
> - **UPDATE_COMPLETE** (μ΄λ΅μƒ‰): λ¨λ“  λ¦¬μ†μ¤ μ—…λ°μ΄νΈ μ™„λ£
> - **UPDATE_ROLLBACK_IN_PROGRESS**: μ—…λ°μ΄νΈ μ‹¤ν¨, μ΄μ „ μƒνƒλ΅ λ΅¤λ°± μ¤‘
> - **UPDATE_ROLLBACK_COMPLETE**: λ΅¤λ°± μ™„λ£, μ΄μ „ μƒνƒλ΅ λ³µμ›λ¨
> 
> **Change set previewμ μ¤‘μ”μ„±:**
> 
> - μ‹¤μ  μ—…λ°μ΄νΈ μ „μ— λ³€κ²½ μ‚¬ν•­μ„ ν™•μΈν•©λ‹λ‹¤
> - μ–΄λ–¤ λ¦¬μ†μ¤κ°€ μ¶”κ°€/μμ •/μ‚­μ λλ”μ§€ ν‘μ‹ν•©λ‹λ‹¤
> - Replacement μ—¬λ¶€λ¥Ό λ…ν™•ν λ³΄μ—¬μ¤λ‹λ‹¤ (λ°μ΄ν„° μ†μ‹¤ μ„ν— νμ•…)
> - ν”„λ΅λ•μ… ν™κ²½μ—μ„ μ•μ „ν• μ—…λ°μ΄νΈλ¥Ό μ„ν•΄ ν•„μμ μ…λ‹λ‹¤

### μƒμ„Έ λ‹¨κ³„

1. `s3-with-tags.yaml` νμΌμ„ ν…μ¤νΈ μ—λ””ν„°λ΅ μ—½λ‹λ‹¤.
2. ν…ν”λ¦Ώ λ‚΄μ©μ„ ν™•μΈν•©λ‹λ‹¤:

```yaml
AWSTemplateFormatVersion: '2010-09-09'
Description: 'Amazon S3 bucket with additional tags'

Parameters:
  BucketPrefix:
    Type: String
    Default: cfn-demo-bucket
    Description: Amazon S3 bucket name prefix

Resources:
  DemoBucket:
    Type: AWS::Amazon S3::Bucket
    Properties:
      BucketName: !Sub '${BucketPrefix}-${AWS::AccountId}'
      Tags:
        - Key: Purpose
          Value: AWS CloudFormation Demo
        - Key: Environment
          Value: Development
        - Key: ManagedBy
          Value: AWS CloudFormation

Outputs:
  BucketName:
    Description: Name of the Amazon S3 bucket
    Value: !Ref DemoBucket
```

> [!NOTE]
> μ΄ ν…ν”λ¦Ώμ€ κΈ°μ΅΄ ν…ν”λ¦Ώμ— 2κ°μ νƒκ·Έ(Environment, ManagedBy)λ¥Ό μ¶”κ°€ν• λ²„μ „μ…λ‹λ‹¤.
> λ²„ν‚· μ΄λ¦„μ€ λ™μΌν•λ―€λ΅ κΈ°μ΅΄ λ²„ν‚·μ΄ μμ •λ©λ‹λ‹¤.

3. AWS CloudFormation μ½μ†”λ΅ μ΄λ™ν•©λ‹λ‹¤.
4. `demo-s3-stack`μ„ μ„ νƒν•©λ‹λ‹¤.
5. [[Update]] λ²„νΌμ„ ν΄λ¦­ν•©λ‹λ‹¤.
6. **Prerequisite - Prepare template**μ—μ„ `Replace current template`μ„ μ„ νƒν•©λ‹λ‹¤.
7. **Specify template**μ—μ„ `Upload a template file`μ„ μ„ νƒν•©λ‹λ‹¤.
8. [[Choose file]] λ²„νΌμ„ ν΄λ¦­ν• ν›„ `s3-with-tags.yaml` νμΌμ„ μ„ νƒν•©λ‹λ‹¤.
9. [[Next]] λ²„νΌμ„ ν΄λ¦­ν•©λ‹λ‹¤.
10. **Parameters** νμ΄μ§€μ—μ„ κΈ°λ³Έκ°’μ„ μ μ§€ν•κ³  [[Next]] λ²„νΌμ„ ν΄λ¦­ν•©λ‹λ‹¤.
11. **Configure stack options** νμ΄μ§€μ—μ„ κΈ°λ³Έκ°’μ„ μ μ§€ν•κ³  [[Next]] λ²„νΌμ„ ν΄λ¦­ν•©λ‹λ‹¤.
12. **Review and create** νμ΄μ§€ ν•λ‹¨μ **Change set preview** μ„Ήμ…μΌλ΅ μ¤ν¬λ΅¤ν•©λ‹λ‹¤.

> [!NOTE]
> **Change set preview**λ” Direct Update λ°©μ‹μ—μ„ λ³€κ²½ μ‚¬ν•­μ„ λ―Έλ¦¬ λ³΄μ—¬μ£Όλ” μ„Ήμ…μ…λ‹λ‹¤.
> λ³„λ„μ λ³€κ²½ μ„ΈνΈλ¥Ό μƒμ„±ν•μ§€ μ•κ³ , μ—…λ°μ΄νΈ μ „μ— μ–΄λ–¤ λ¦¬μ†μ¤κ°€ μ–΄λ–»κ² λ³€κ²½λλ”μ§€ ν™•μΈν•  μ μμµλ‹λ‹¤.

13. λ³€κ²½ μ„ΈνΈ μ •λ³΄λ¥Ό ν™•μΈν•©λ‹λ‹¤:
    - **Action**: `Modify` (κΈ°μ΅΄ λ¦¬μ†μ¤ μμ •)
    - **Logical ID**: `DemoBucket`
    - **Physical ID**: μ‹¤μ  λ²„ν‚· μ΄λ¦„
    - **Resource type**: `AWS::Amazon S3::Bucket`
    - **Replacement**: `False` (λ¦¬μ†μ¤ κµμ²΄ μ—†μ, λ°μ΄ν„° μ•μ „)
    - **Scope**: `Tags` (νƒκ·Έλ§ λ³€κ²½)

> [!CONCEPT] λ³€κ²½ μ„ΈνΈ μ •λ³΄ ν•΄μ„
> - **Action**: `Modify` - κΈ°μ΅΄ λ¦¬μ†μ¤λ¥Ό μμ •ν•©λ‹λ‹¤ (μ¶”κ°€/μ‚­μ  μ•„λ‹)
> - **Replacement**: `False` - λ¦¬μ†μ¤κ°€ κµμ²΄λμ§€ μ•μµλ‹λ‹¤ (λ°μ΄ν„° μ μ§€)
> - **Scope**: `Tags` - νƒκ·Έλ§ λ³€κ²½λ©λ‹λ‹¤ (λ²„ν‚· μ΄λ¦„μ΄λ‚ μ„¤μ •μ€ λ³€κ²½ μ—†μ)
> 
> μ΄ λ³€κ²½μ€ μ•μ „ν•©λ‹λ‹¤. κΈ°μ΅΄ λ²„ν‚·μ— νƒκ·Έλ§ μ¶”κ°€λκ³  λ°μ΄ν„°λ” κ·Έλ€λ΅ μ μ§€λ©λ‹λ‹¤.
> 
> **Direct Update vs Change Set**:
> - **Direct Update** (ν„μ¬ λ°©μ‹): Review νμ΄μ§€μ—μ„ λ³€κ²½ μ‚¬ν•­μ„ λ―Έλ¦¬ ν™•μΈν•κ³  μ¦‰μ‹ μ μ©
> - **Change Set** (λ³„λ„ μƒμ„±): Stack actions β†’ Create change set for current stackμΌλ΅ λ³€κ²½ μ„ΈνΈλ¥Ό λ³„λ„λ΅ μƒμ„±ν•μ—¬ κ²€ν†  ν›„ μ‹¤ν–‰

14. [[Submit]] λ²„νΌμ„ ν΄λ¦­ν•©λ‹λ‹¤.
15. μ¤νƒ μ—…λ°μ΄νΈκ°€ μ‹μ‘λ©λ‹λ‹¤. μƒνƒκ°€ "UPDATE_IN_PROGRESS"λ΅ ν‘μ‹λ©λ‹λ‹¤.

> [!NOTE]
> μ¤νƒ μ—…λ°μ΄νΈμ— 1-2λ¶„μ΄ μ†μ”λ©λ‹λ‹¤. **Events** νƒ­μ—μ„ μ—…λ°μ΄νΈ κ³Όμ •μ„ ν™•μΈν•  μ μμµλ‹λ‹¤.

16. μƒνƒκ°€ "UPDATE_COMPLETE"λ΅ λ³€κ²½λ  λ•κΉμ§€ κΈ°λ‹¤λ¦½λ‹λ‹¤.
17. **Resources** νƒ­μ„ μ„ νƒν•©λ‹λ‹¤.
18. **DemoBucket** λ¦¬μ†μ¤μ **Physical ID**λ¥Ό ν΄λ¦­ν•©λ‹λ‹¤.
19. Amazon S3 μ½μ†”μ—μ„ **Properties** νƒ­μ„ μ„ νƒν•©λ‹λ‹¤.
20. ν•λ‹¨μ **Tags** μ„Ήμ…μΌλ΅ μ¤ν¬λ΅¤ν•©λ‹λ‹¤.
21. ν…ν”λ¦Ώμ— μ •μλ 3κ°μ νƒκ·Έκ°€ μλ”μ§€ ν™•μΈν•©λ‹λ‹¤:
    - `Purpose: AWS CloudFormation Demo`
    - `Environment: Development`
    - `ManagedBy: AWS CloudFormation`

> [!NOTE]
> νƒμ¤ν¬ 1μ—μ„ μ¤νƒ μƒμ„± μ‹ μ¶”κ°€ν• 3κ°μ μ¤νƒ νƒκ·Έ(`Project`, `Week`, `CreatedBy`)λ” μ¤νƒμ΄ μƒμ„±ν•λ” λ¨λ“  λ¦¬μ†μ¤μ— μλ™μΌλ΅ μ „νλ©λ‹λ‹¤.
> λ”°λΌμ„ Amazon S3 λ²„ν‚·μ—λ” μ΄ 6κ°μ νƒκ·Έκ°€ ν‘μ‹λ©λ‹λ‹¤:
> - **ν…ν”λ¦Ώ μ •μ νƒκ·Έ** (3κ°): Purpose, Environment, ManagedBy
> - **μ¤νƒ νƒκ·Έ** (3κ°): Project, Week, CreatedBy
> 
> νƒμ¤ν¬ 1μ—μ„λ” ν…ν”λ¦Ώ μ •μ νƒκ·Έ 1κ°(Purpose)μ™€ μ¤νƒ νƒκ·Έ 3κ°κ°€ μμ—μµλ‹λ‹¤. νƒμ¤ν¬ 2 μ—…λ°μ΄νΈ ν›„ ν…ν”λ¦Ώ μ •μ νƒκ·Έκ°€ 3κ°(Purpose, Environment, ManagedBy)λ΅ λμ–΄λ‚ μ΄ 6κ°κ°€ λμ—μµλ‹λ‹¤.

> [!IMPORTANT]
> Replacementκ°€ TrueμΈ κ²½μ° λ°λ“μ‹ λ°μ΄ν„° λ°±μ—…μ„ λ¨Όμ € μν–‰ν•΄μ•Ό ν•©λ‹λ‹¤.
> νΉν λ°μ΄ν„°λ² μ΄μ¤, μ¤ν† λ¦¬μ§€ λ¦¬μ†μ¤λ” μ‹ μ¤‘ν•κ² κ²€ν† ν•©λ‹λ‹¤.

β… **νƒμ¤ν¬ μ™„λ£**: μ¤νƒ μ—…λ°μ΄νΈ(UPDATE) μƒλ…μ£ΌκΈ°λ¥Ό μ‹μ—°ν–μµλ‹λ‹¤.

## νƒμ¤ν¬ 3: λ“λ¦¬ν”„νΈ νƒμ§€ - μλ™ λ³€κ²½ κ°μ§€

μ΄ νƒμ¤ν¬μ—μ„λ” λ“λ¦¬ν”„νΈ νƒμ§€ κΈ°λ¥μ„ μ‚¬μ©ν•μ—¬ AWS CloudFormation μ™Έλ¶€μ—μ„ μλ™μΌλ΅ λ³€κ²½λ λ¦¬μ†μ¤λ¥Ό μ°Ύμ•„λƒ…λ‹λ‹¤. Amazon S3 μ½μ†”μ—μ„ μλ™μΌλ΅ νƒκ·Έλ¥Ό μ¶”κ°€ν• ν›„ λ“λ¦¬ν”„νΈλ¥Ό κ°μ§€ν•©λ‹λ‹¤.

> [!CONCEPT] λ“λ¦¬ν”„νΈ (Drift) νƒμ§€
> λ“λ¦¬ν”„νΈλ” AWS CloudFormation ν…ν”λ¦Ώκ³Ό μ‹¤μ  λ¦¬μ†μ¤ μƒνƒμ λ¶μΌμΉλ¥Ό μλ―Έν•©λ‹λ‹¤.
> AWS μ½μ†”, CLI, APIλ¥Ό ν†µν• μλ™ λ³€κ²½μΌλ΅ λ°μƒν•λ©°, μΈν”„λΌ μΌκ΄€μ„±μ„ ν•΄μΉ©λ‹λ‹¤.
> 
> **λ“λ¦¬ν”„νΈ λ°μƒ μ›μΈ:**
>
> - κ°λ°μκ°€ AWS μ½μ†”μ—μ„ μ§μ ‘ νƒκ·Έλ¥Ό μ¶”κ°€ν•©λ‹λ‹¤
> - μ΄μν€μ΄ λ³΄μ• κ·Έλ£Ή κ·μΉ™μ„ μλ™μΌλ΅ μμ •ν•©λ‹λ‹¤
> - μλ™ν™” μ¤ν¬λ¦½νΈκ°€ λ¦¬μ†μ¤ μ†μ„±μ„ λ³€κ²½ν•©λ‹λ‹¤
> - λ‹¤λ¥Έ AWS CloudFormation μ¤νƒμ΄ λ™μΌν• λ¦¬μ†μ¤λ¥Ό μμ •ν•©λ‹λ‹¤
>
> 
> **λ“λ¦¬ν”„νΈ νƒμ§€ ν”„λ΅μ„Έμ¤:**
>
> - **ν…ν”λ¦Ώ λΉ„κµ**: AWS CloudFormationμ΄ ν…ν”λ¦Ώκ³Ό μ‹¤μ  λ¦¬μ†μ¤λ¥Ό λΉ„κµν•©λ‹λ‹¤
> - **μ°¨μ΄μ  μ‹λ³„**: κ° λ¦¬μ†μ¤μ μ†μ„±μ„ ν•λ‚μ”© ν™•μΈν•μ—¬ μ°¨μ΄μ μ„ μ°Ύμµλ‹λ‹¤
> - **μƒνƒ μ—…λ°μ΄νΈ**: λ“λ¦¬ν”„νΈκ°€ λ°κ²¬λλ©΄ μ¤νƒ μƒνƒλ¥Ό DRIFTEDλ΅ λ³€κ²½ν•©λ‹λ‹¤
> - **μƒμ„Έ μ •λ³΄ μ κ³µ**: Expected vs Actual κ°’μ„ λΉ„κµν•μ—¬ μ •ν™•ν• μ°¨μ΄μ μ„ ν‘μ‹ν•©λ‹λ‹¤
>

### μƒμ„Έ λ‹¨κ³„

#### 1λ‹¨κ³„: μλ™μΌλ΅ νƒκ·Έ μ¶”κ°€ (λ“λ¦¬ν”„νΈ λ°μƒ)

1. Amazon S3 μ½μ†”λ΅ μ΄λ™ν•©λ‹λ‹¤.
2. `cfn-demo-bucket-`λ΅ μ‹μ‘ν•λ” λ²„ν‚·μ„ μ„ νƒν•©λ‹λ‹¤.
3. **Properties** νƒ­μ„ μ„ νƒν•©λ‹λ‹¤.
4. ν•λ‹¨μ **Tags** μ„Ήμ…μΌλ΅ μ¤ν¬λ΅¤ν•©λ‹λ‹¤.
5. [[Edit]] λ²„νΌμ„ ν΄λ¦­ν•©λ‹λ‹¤.
6. [[Add tag]] λ²„νΌμ„ ν΄λ¦­ν•©λ‹λ‹¤.
7. λ‹¤μ νƒκ·Έλ¥Ό μ¶”κ°€ν•©λ‹λ‹¤:
   - **Key**: `ManualTag`
   - **Value**: `AddedManually`
8. [[Save changes]] λ²„νΌμ„ ν΄λ¦­ν•©λ‹λ‹¤.

> [!NOTE]
> μ΄ νƒκ·Έλ” AWS CloudFormation ν…ν”λ¦Ώμ— μ •μλμ§€ μ•μ•μΌλ―€λ΅ λ“λ¦¬ν”„νΈκ°€ λ°μƒν•©λ‹λ‹¤.
> AWS CloudFormationμ€ μ΄ λ³€κ²½μ„ μΈμ‹ν•μ§€ λ»ν•κ³  μμµλ‹λ‹¤.

#### 2λ‹¨κ³„: λ“λ¦¬ν”„νΈ κ°μ§€ μ‹¤ν–‰

1. AWS CloudFormation μ½μ†”λ΅ μ΄λ™ν•©λ‹λ‹¤.
2. `demo-s3-stack`μ„ μ„ νƒν•©λ‹λ‹¤.
3. **Stack actions** λ“λ΅­λ‹¤μ΄μ„ ν΄λ¦­ν•©λ‹λ‹¤.
4. `Detect drift`λ¥Ό μ„ νƒν•©λ‹λ‹¤.
5. ν™•μΈ μ°½μ—μ„ [[Detect drift]] λ²„νΌμ„ ν΄λ¦­ν•©λ‹λ‹¤.

> [!NOTE]
> λ“λ¦¬ν”„νΈ κ°μ§€μ— 1-2λ¶„μ΄ μ†μ”λ©λ‹λ‹¤. AWS CloudFormationμ΄ ν…ν”λ¦Ώκ³Ό μ‹¤μ  λ¦¬μ†μ¤λ¥Ό λΉ„κµν•©λ‹λ‹¤.

6. νμ΄μ§€λ¥Ό μƒλ΅κ³ μΉ¨ν•©λ‹λ‹¤.
7. **Stack info** νƒ­μ—μ„ **Drift status**λ¥Ό ν™•μΈν•©λ‹λ‹¤.
8. μƒνƒκ°€ "DRIFTED"λ΅ ν‘μ‹λλ”μ§€ ν™•μΈν•©λ‹λ‹¤.

#### 3λ‹¨κ³„: λ“λ¦¬ν”„νΈ μƒμ„Έ μ •λ³΄ ν™•μΈ

1. **Stack actions** λ“λ΅­λ‹¤μ΄μ„ ν΄λ¦­ν•©λ‹λ‹¤.
2. `View drift results`λ¥Ό μ„ νƒν•©λ‹λ‹¤.
3. **Resource drift status** νƒ­μ—μ„ λ“λ¦¬ν”„νΈκ°€ λ°μƒν• λ¦¬μ†μ¤λ¥Ό ν™•μΈν•©λ‹λ‹¤.
4. **DemoBucket** λ¦¬μ†μ¤μ **Drift status**κ°€ "DRIFTED"μΈμ§€ ν™•μΈν•©λ‹λ‹¤.
5. **DemoBucket** λ¦¬μ†μ¤λ¥Ό μ„ νƒν•©λ‹λ‹¤.
6. [[View drift details]] λ²„νΌμ„ ν΄λ¦­ν•©λ‹λ‹¤.
7. λ“λ¦¬ν”„νΈ μ°¨μ΄μ μ„ ν™•μΈν•©λ‹λ‹¤:
   - **Expected**: ν…ν”λ¦Ώμ— μ •μλ νƒκ·Έ (3κ°: Purpose, Environment, ManagedBy)
   - **Actual**: ν…ν”λ¦Ώ μ •μ νƒκ·Έ 3κ° + μλ™ μ¶”κ°€ νƒκ·Έ 1κ° (ManualTag)
   - **Difference Type**: `NOT_EQUAL` (κ°’μ΄ λ‹¤λ¦„)

> [!NOTE]
> λ“λ¦¬ν”„νΈ νƒμ§€λ” AWS CloudFormation ν…ν”λ¦Ώμ— λ…μ‹μ μΌλ΅ μ •μλ μ†μ„±λ§ λΉ„κµν•λ©°, μ¤νƒ μμ¤€ νƒκ·Έ(`Project`, `Week`, `CreatedBy`)λ” λΉ„κµ λ€μƒμ— ν¬ν•¨λμ§€ μ•μµλ‹λ‹¤.
> λ”°λΌμ„ Expectedλ” ν…ν”λ¦Ώμ 3κ° νƒκ·Έ, Actualμ€ ν…ν”λ¦Ώ 3κ° + μλ™ μ¶”κ°€ 1κ°λ΅ ν‘μ‹λ©λ‹λ‹¤.

> [!NOTE]
> μ΄ λ°λ¨μ—μ„λ” λ“λ¦¬ν”„νΈλ¥Ό μμ •ν•μ§€ μ•κ³  κ·Έλ€λ΅ λ‘΅λ‹λ‹¤.
> λ“λ¦¬ν”„νΈ κ°μ§€μ λ©μ μ€ λ³€κ²½μ„ μλ™μΌλ΅ μμ •ν•λ” κ²ƒμ΄ μ•„λ‹λΌ κ΄€λ¦¬μμ—κ² μ•λ¦¬λ” κ²ƒμ…λ‹λ‹¤.
> 
> **λ“λ¦¬ν”„νΈ μμ • λ°©λ²•:**
> 
> - **λ°©λ²• 1**: ν…ν”λ¦Ώμ— `ManualTag`λ¥Ό μ¶”κ°€ν•μ—¬ μ‹¤μ  μƒνƒλ¥Ό λ°μν•©λ‹λ‹¤ (κ¶μ¥)
> - **λ°©λ²• 2**: Amazon S3 μ½μ†”μ—μ„ `ManualTag`λ¥Ό μ‚­μ ν•μ—¬ ν…ν”λ¦Ώκ³Ό μΌμΉμ‹ν‚µλ‹λ‹¤

β… **νƒμ¤ν¬ μ™„λ£**: λ“λ¦¬ν”„νΈ νƒμ§€λ΅ μλ™ λ³€κ²½μ„ κ°μ§€ν–μµλ‹λ‹¤.

## νƒμ¤ν¬ 4: μ¤νƒ μ‚­μ  (DELETE) - μƒλ…μ£ΌκΈ° μ™„λ£

μ΄ νƒμ¤ν¬μ—μ„λ” μ¤νƒ μ‚­μ  μƒλ…μ£ΌκΈ°λ¥Ό μ‹μ—°ν•©λ‹λ‹¤. AWS CloudFormation μ¤νƒμ„ μ‚­μ ν•λ©΄μ„ μƒνƒ λ³€ν™”(DELETE_IN_PROGRESS β†’ DELETE_COMPLETE)λ¥Ό κ΄€μ°°ν•κ³ , μ¤νƒμ΄ μƒμ„±ν• λ¨λ“  λ¦¬μ†μ¤κ°€ μλ™μΌλ΅ μ‚­μ λλ” κ³Όμ •μ„ ν™•μΈν•©λ‹λ‹¤.

> [!CONCEPT] μ¤νƒ μ‚­μ  ν”„λ΅μ„Έμ¤
> AWS CloudFormation μ¤νƒ μ‚­μ λ” λ‹¤μ λ‹¨κ³„λ΅ μ§„ν–‰λ©λ‹λ‹¤:
>
> - **μ‚­μ  μμ„ κ²°μ •**: λ¦¬μ†μ¤ κ°„ μμ΅΄μ„±μ„ λ¶„μ„ν•μ—¬ μ—­μμΌλ΅ μ‚­μ ν•©λ‹λ‹¤
> - **λ¦¬μ†μ¤ μ‚­μ **: AWS APIλ¥Ό νΈμ¶ν•μ—¬ κ° λ¦¬μ†μ¤λ¥Ό μ‚­μ ν•©λ‹λ‹¤
> - **μƒνƒ μ¶”μ **: κ° λ¦¬μ†μ¤μ μ‚­μ  μƒνƒλ¥Ό λ¨λ‹ν„°λ§ν•©λ‹λ‹¤
> - **μ™„λ£**: λ¨λ“  λ¦¬μ†μ¤κ°€ μ„±κ³µμ μΌλ΅ μ‚­μ λλ©΄ μ¤νƒμ΄ λ©λ΅μ—μ„ μ‚¬λΌμ§‘λ‹λ‹¤
>
> 
> **μƒνƒ λ³€ν™”:**
>
> - **DELETE_IN_PROGRESS** (μ£Όν™©μƒ‰): λ¦¬μ†μ¤ μ‚­μ  μ¤‘
> - **DELETE_COMPLETE** (μ΄λ΅μƒ‰): λ¨λ“  λ¦¬μ†μ¤ μ‚­μ  μ™„λ£, μ¤νƒμ΄ λ©λ΅μ—μ„ μ κ±°λ¨
> - **DELETE_FAILED** (λΉ¨κ°„μƒ‰): μ‚­μ  μ‹¤ν¨ (μλ™ κ°μ… ν•„μ”)
>
> 
> **μλ™ μ‚­μ μ μ¥μ :**
>
> - μ¤νƒμ΄ μƒμ„±ν• λ¨λ“  λ¦¬μ†μ¤λ¥Ό ν• λ²μ— μ‚­μ ν•  μ μμµλ‹λ‹¤
> - λ¦¬μ†μ¤ κ°„ μμ΅΄μ„±μ„ μλ™μΌλ΅ μ²λ¦¬ν•©λ‹λ‹¤
> - μλ™ μ‚­μ  μ‹ λ°μƒν•  μ μλ” λ„λ½μ„ λ°©μ§€ν•©λ‹λ‹¤
> - μΈν”„λΌ μ •λ¦¬κ°€ κ°„νΈν•κ³  μ•μ „ν•©λ‹λ‹¤
>

### μƒμ„Έ λ‹¨κ³„

#### 1λ‹¨κ³„: Amazon S3 λ²„ν‚· λΉ„μ°κΈ° (ν•„μ”μ‹)

> [!NOTE]
> μ΄ λ°λ¨μ—μ„λ” λ²„ν‚·μ— νμΌμ„ μ—…λ΅λ“ν•μ§€ μ•μ•μΌλ―€λ΅ μ΄ λ‹¨κ³„λ” κ±΄λ„λ›Έ μ μμµλ‹λ‹¤.
> 
> Amazon S3 λ²„ν‚·μ— νμΌμ΄ μμΌλ©΄ AWS CloudFormation μ¤νƒ μ‚­μ κ°€ μ‹¤ν¨ν•©λ‹λ‹¤.
> λ²„ν‚·μ— νμΌμ„ μ—…λ΅λ“ν• κ²½μ°μ—λ§ λ‹¤μ λ‹¨κ³„λ¥Ό μν–‰ν•©λ‹λ‹¤.

1. Amazon S3 μ½μ†”λ΅ μ΄λ™ν•©λ‹λ‹¤.
2. `cfn-demo-bucket-`λ΅ μ‹μ‘ν•λ” λ²„ν‚·μ„ μ„ νƒν•©λ‹λ‹¤.
3. [[Empty]] λ²„νΌμ„ ν΄λ¦­ν•©λ‹λ‹¤.
4. ν™•μΈ μ°½μ—μ„ `permanently delete`λ¥Ό μ…λ ¥ν•©λ‹λ‹¤.
5. [[Empty]] λ²„νΌμ„ ν΄λ¦­ν•©λ‹λ‹¤.

#### 2λ‹¨κ³„: AWS CloudFormation μ¤νƒ μ‚­μ 

1. AWS CloudFormation μ½μ†”λ΅ μ΄λ™ν•©λ‹λ‹¤.
2. `demo-s3-stack`μ„ μ„ νƒν•©λ‹λ‹¤.
3. [[Delete]] λ²„νΌμ„ ν΄λ¦­ν•©λ‹λ‹¤.
4. ν™•μΈ μ°½μ—μ„ [[Delete]] λ²„νΌμ„ ν΄λ¦­ν•©λ‹λ‹¤.
5. μ¤νƒ μ‚­μ κ°€ μ‹μ‘λ©λ‹λ‹¤. μƒνƒκ°€ "DELETE_IN_PROGRESS"λ΅ ν‘μ‹λ©λ‹λ‹¤.

> [!NOTE]
> μ¤νƒ μ‚­μ μ— 1-2λ¶„μ΄ μ†μ”λ©λ‹λ‹¤. **Events** νƒ­μ—μ„ μ‚­μ  κ³Όμ •μ„ ν™•μΈν•  μ μμµλ‹λ‹¤.
> AWS CloudFormationμ΄ Amazon S3 λ²„ν‚·μ„ μ‚­μ ν•λ” κ³Όμ •μ„ μ‹¤μ‹κ°„μΌλ΅ κ΄€μ°°ν•©λ‹λ‹¤.

6. μƒνƒκ°€ "DELETE_COMPLETE"λ΅ λ³€κ²½λ  λ•κΉμ§€ κΈ°λ‹¤λ¦½λ‹λ‹¤.
7. μ¤νƒμ΄ λ©λ΅μ—μ„ μ‚¬λΌμ§€λ” κ²ƒμ„ ν™•μΈν•©λ‹λ‹¤.

> [!NOTE]
> DELETE_COMPLETE μƒνƒκ°€ λλ©΄ μ¤νƒμ΄ μλ™μΌλ΅ λ©λ΅μ—μ„ μ κ±°λ©λ‹λ‹¤.
> μ΄λ” μ¤νƒκ³Ό λ¨λ“  λ¦¬μ†μ¤κ°€ μ„±κ³µμ μΌλ΅ μ‚­μ λμ—μμ„ μλ―Έν•©λ‹λ‹¤.

#### 3λ‹¨κ³„: λ¦¬μ†μ¤ μ‚­μ  ν™•μΈ

1. Amazon S3 μ½μ†”λ΅ μ΄λ™ν•©λ‹λ‹¤.
2. `cfn-demo-bucket-`λ΅ μ‹μ‘ν•λ” λ²„ν‚·μ΄ λ©λ΅μ—μ„ μ‚¬λΌμ΅λ”μ§€ ν™•μΈν•©λ‹λ‹¤.

> [!SUCCESS]
> AWS CloudFormation μ¤νƒμ„ μ‚­μ ν•λ©΄ μ¤νƒμ΄ μƒμ„±ν• λ¨λ“  λ¦¬μ†μ¤(Amazon S3 λ²„ν‚·)κ°€ μλ™μΌλ΅ μ‚­μ λ©λ‹λ‹¤.
> μλ™μΌλ΅ κ° λ¦¬μ†μ¤λ¥Ό μ‚­μ ν•  ν•„μ”κ°€ μ—†μµλ‹λ‹¤.

β… **νƒμ¤ν¬ μ™„λ£**: μ¤νƒ μ‚­μ (DELETE) μƒλ…μ£ΌκΈ°λ¥Ό μ‹μ—°ν•κ³  μ „μ²΄ μƒλ…μ£ΌκΈ°λ¥Ό μ™„λ£ν–μµλ‹λ‹¤.

## λ§λ¬΄λ¦¬

μ΄ λ°λ¨μ—μ„ λ‹¤μμ„ μ„±κ³µμ μΌλ΅ μ‹μ—°ν–μµλ‹λ‹¤:

- **μ¤νƒ μƒμ„± (CREATE)**: κ°„λ‹¨ν• Amazon S3 λ²„ν‚· μ¤νƒμ„ μƒμ„±ν•κ³  μƒνƒ λ³€ν™”λ¥Ό κ΄€μ°°ν–μµλ‹λ‹¤
- **μ¤νƒ μ—…λ°μ΄νΈ (UPDATE)**: Change set previewλ΅ λ³€κ²½ μ‚¬ν•­μ„ λ―Έλ¦¬ ν™•μΈν•κ³  μ•μ „ν•κ² μ—…λ°μ΄νΈν–μµλ‹λ‹¤
- **λ“λ¦¬ν”„νΈ νƒμ§€**: μλ™μΌλ΅ λ³€κ²½λ λ¦¬μ†μ¤λ¥Ό κ°μ§€ν•κ³  ν…ν”λ¦Ώκ³Όμ μ°¨μ΄μ μ„ ν™•μΈν–μµλ‹λ‹¤
- **μ¤νƒ μ‚­μ  (DELETE)**: μ¤νƒκ³Ό λ¨λ“  λ¦¬μ†μ¤λ¥Ό μλ™μΌλ΅ μ‚­μ ν•κ³  μƒλ…μ£ΌκΈ°λ¥Ό μ™„λ£ν–μµλ‹λ‹¤

λ‹¤μ μ„Έμ…μ—μ„λ” μ‹¤μ λ΅ AWS CloudFormation ν…ν”λ¦Ώμ„ μ‘μ„±ν•μ—¬ Amazon VPC ν™κ²½μ„ κµ¬μ¶•ν•λ” μ‹¤μµμ„ μ§„ν–‰ν•©λ‹λ‹¤.

## μ¶”κ°€ ν•™μµ λ¦¬μ†μ¤

- [AWS CloudFormation μ‚¬μ© μ„¤λ…μ„](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/Welcome.html)
- [AWS CloudFormation ν…ν”λ¦Ώ λ νΌλ°μ¤](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/template-reference.html)
- [AWS CloudFormation λ¨λ²” μ‚¬λ΅€](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/best-practices.html)
- [λ³€κ²½ μ„ΈνΈ μ‚¬μ©](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-changesets.html)
- [λ“λ¦¬ν”„νΈ κ°μ§€](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-stack-drift.html)

## π“ μ°Έκ³ : AWS CloudFormation ν•µμ‹¬ κ°λ…

### Infrastructure as Code (IaC)

**IaCλ€?**
- μΈν”„λΌλ¥Ό μ½”λ“λ΅ μ •μν•κ³  κ΄€λ¦¬ν•λ” λ°©μ‹μ…λ‹λ‹¤.
- μλ™ μ‘μ—… λ€μ‹  ν…ν”λ¦Ώ νμΌλ΅ λ¦¬μ†μ¤λ¥Ό μƒμ„±ν•©λ‹λ‹¤.
- λ²„μ „ κ΄€λ¦¬, μ¬μ‚¬μ©, μλ™ν™”κ°€ κ°€λ¥ν•©λ‹λ‹¤.

**μ „ν†µμ  λ°©μ‹ vs IaC**

| κµ¬λ¶„ | μ „ν†µμ  λ°©μ‹ | Infrastructure as Code |
|------|------------|----------------------|
| **λ¦¬μ†μ¤ μƒμ„±** | AWS μ½μ†”μ—μ„ μλ™ ν΄λ¦­ | ν…ν”λ¦Ώ νμΌλ΅ μλ™ μƒμ„± |
| **μΌκ΄€μ„±** | μ‚¬λλ§λ‹¤ λ‹¤λ¥΄κ² μ„¤μ • κ°€λ¥ | ν•­μƒ λ™μΌν• κ²°κ³Ό λ³΄μ¥ |
| **μ¬μ‚¬μ©** | λ§¤λ² μ²μλ¶€ν„° λ‹¤μ‹ μƒμ„± | ν…ν”λ¦Ώ μ¬μ‚¬μ©μΌλ΅ λΉ λ¥Έ λ°°ν¬ |
| **λ²„μ „ κ΄€λ¦¬** | λ³€κ²½ μ΄λ ¥ μ¶”μ  μ–΄λ ¤μ›€ | Git λ“±μΌλ΅ λ³€κ²½ μ΄λ ¥ κ΄€λ¦¬ |
| **λ¬Έμ„ν™”** | λ³„λ„ λ¬Έμ„ μ‘μ„± ν•„μ” | ν…ν”λ¦Ώ μμ²΄κ°€ λ¬Έμ„ μ—­ν•  |
| **μ¤λ¥ κ°€λ¥μ„±** | μλ™ μ‘μ—…μΌλ΅ μ‹¤μ λ°μƒ | μλ™ν™”λ΅ μ‹¤μ μµμ†ν™” |

**IaCμ μ¥μ **
- **μ†λ„**: λ‡ λ¶„ λ§μ— μ „μ²΄ μΈν”„λΌ κµ¬μ¶•
- **μΌκ΄€μ„±**: κ°λ°/μ¤ν…μ΄μ§•/ν”„λ΅λ•μ… ν™κ²½ λ™μΌν•κ² κµ¬μ„±
- **μ¬μ‚¬μ©**: ν…ν”λ¦Ώμ„ μ—¬λ¬ ν”„λ΅μ νΈμ—μ„ μ¬μ‚¬μ©
- **λ²„μ „ κ΄€λ¦¬**: GitμΌλ΅ μΈν”„λΌ λ³€κ²½ μ΄λ ¥ μ¶”μ 
- **ν‘μ—…**: ν€μ› κ°„ μΈν”„λΌ μ½”λ“ κ³µμ  λ° λ¦¬λ·°
- **μλ™ν™”**: CI/CD νμ΄ν”„λΌμΈμ— ν†µν•© κ°€λ¥

### AWS CloudFormation ν…ν”λ¦Ώ κµ¬μ΅°

**μ£Όμ” μ„Ήμ…**

```yaml
AWSTemplateFormatVersion: '2010-09-09'
Description: 'ν…ν”λ¦Ώ μ„¤λ…'

Parameters:
  # μ‚¬μ©μ μ…λ ¥κ°’ μ •μ
  BucketPrefix:
    Type: String
    Default: my-bucket
    Description: Amazon S3 λ²„ν‚· μ΄λ¦„ μ ‘λ‘μ‚¬

Resources:
  # μƒμ„±ν•  AWS λ¦¬μ†μ¤ μ •μ
  MyBucket:
    Type: AWS::Amazon S3::Bucket
    Properties:
      BucketName: !Sub '${BucketPrefix}-${AWS::AccountId}'

Outputs:
  # μ¤νƒ μƒμ„± ν›„ μ¶λ ¥ν•  κ°’
  BucketName:
    Description: μƒμ„±λ λ²„ν‚· μ΄λ¦„
    Value: !Ref MyBucket
```

**μ„Ήμ…λ³„ μ„¤λ…**

| μ„Ήμ… | ν•„μ μ—¬λ¶€ | μ„¤λ… |
|------|----------|------|
| `AWSTemplateFormatVersion` | μ„ νƒ | ν…ν”λ¦Ώ λ²„μ „ (ν„μ¬ `2010-09-09`λ§ μ§€μ›) |
| `Description` | μ„ νƒ | ν…ν”λ¦Ώ μ„¤λ… (μµλ€ 1024μ) |
| `Parameters` | μ„ νƒ | μ‚¬μ©μ μ…λ ¥κ°’ μ •μ (μ¬μ‚¬μ©μ„± ν–¥μƒ) |
| `Resources` | **ν•„μ** | μƒμ„±ν•  AWS λ¦¬μ†μ¤ μ •μ |
| `Outputs` | μ„ νƒ | μ¤νƒ μƒμ„± ν›„ μ¶λ ¥ν•  κ°’ (λ‹¤λ¥Έ μ¤νƒμ—μ„ μ°Έμ΅° κ°€λ¥) |

### AWS CloudFormation λ‚΄μ¥ ν•¨μ

**μ£Όμ” λ‚΄μ¥ ν•¨μ**

| ν•¨μ | μ„¤λ… | μμ‹ |
|------|------|------|
| `!Ref` | λ¦¬μ†μ¤ λλ” νλΌλ―Έν„° μ°Έμ΅° | `!Ref MyBucket` β†’ λ²„ν‚· μ΄λ¦„ |
| `!Sub` | λ¬Έμμ—΄ μΉν™ | `!Sub '${BucketPrefix}-${AWS::AccountId}'` |
| `!GetAtt` | λ¦¬μ†μ¤ μ†μ„± κ°€μ Έμ¤κΈ° | `!GetAtt MyBucket.Arn` β†’ λ²„ν‚· ARN |
| `!Join` | λ¬Έμμ—΄ κ²°ν•© | `!Join ['-', [my, bucket, name]]` |
| `!Select` | λ¦¬μ¤νΈμ—μ„ κ°’ μ„ νƒ | `!Select [0, !GetAZs '']` β†’ μ²« λ²μ§Έ AZ |

**μμ‹: !Ref ν•¨μ**

```yaml
Resources:
  MyBucket:
    Type: AWS::Amazon S3::Bucket
    Properties:
      BucketName: my-demo-bucket

Outputs:
  BucketName:
    Value: !Ref MyBucket  # my-demo-bucket λ°ν™
```

**μμ‹: !Sub ν•¨μ**

```yaml
Parameters:
  Environment:
    Type: String
    Default: dev

Resources:
  MyBucket:
    Type: AWS::Amazon S3::Bucket
    Properties:
      BucketName: !Sub 'app-${Environment}-${AWS::AccountId}'
      # κ²°κ³Ό: app-dev-123456789012
```

**μμ‹: !GetAtt ν•¨μ**

```yaml
Resources:
  MyBucket:
    Type: AWS::Amazon S3::Bucket

Outputs:
  BucketArn:
    Value: !GetAtt MyBucket.Arn
    # κ²°κ³Ό: arn:aws:s3:::my-bucket-name
```

### IaC λ„κµ¬ λΉ„κµ

**AWS CloudFormation**
- AWS λ„¤μ΄ν‹°λΈ μ„λΉ„μ¤
- JSON/YAML ν…ν”λ¦Ώ μ‚¬μ©
- AWS λ¦¬μ†μ¤λ§ μ§€μ›
- λ¬΄λ£ (μƒμ„±λ λ¦¬μ†μ¤λ§ κ³ΌκΈ)
- μ„ μ–Έμ  λ°©μ‹

**AWS CDK (Cloud Development Kit)**
- ν”„λ΅κ·Έλλ° μ–Έμ–΄λ΅ μΈν”„λΌ μ •μ (TypeScript, Python, Java λ“±)
- AWS CloudFormationμΌλ΅ λ³€ν™λμ–΄ λ°°ν¬
- μ¬μ‚¬μ© κ°€λ¥ν• μ»΄ν¬λ„νΈ (Constructs)
- νƒ€μ… μ•μ „μ„± λ° IDE μ§€μ›
- λ³µμ΅ν• λ΅μ§ κµ¬ν„ κ°€λ¥

**AWS SAM (Serverless Application Model)**
- μ„λ²„λ¦¬μ¤ μ• ν”λ¦¬μΌ€μ΄μ… μ „μ©
- AWS CloudFormationμ ν™•μ¥
- κ°„μ†ν™”λ λ¬Έλ²•
- λ΅μ»¬ ν…μ¤νΈ μ§€μ›
- AWS Lambda, Amazon API Gateway λ“±μ— μµμ ν™”

**Terraform**
- λ©€ν‹° ν΄λΌμ°λ“ μ§€μ› (AWS, Azure, GCP λ“±)
- HCL μ–Έμ–΄ μ‚¬μ©
- μƒνƒ νμΌ κ΄€λ¦¬ ν•„μ”
- ν’λ¶€ν• ν”„λ΅λ°”μ΄λ” μƒνƒκ³„
- μ„ μ–Έμ  λ°©μ‹

### μ¤νƒ μ •μ±… (Stack Policy)

**λ©μ **:
- μ¤‘μ”ν• λ¦¬μ†μ¤λ¥Ό μ‹¤μλ΅ μ‚­μ ν•κ±°λ‚ κµμ²΄ν•λ” κ²ƒμ„ λ°©μ§€ν•©λ‹λ‹¤.
- ν”„λ΅λ•μ… λ°μ΄ν„°λ² μ΄μ¤, μ¤ν† λ¦¬μ§€ λ“±μ„ λ³΄νΈν•©λ‹λ‹¤.

**μμ‹**:
```json
{
  "Statement": [
    {
      "Effect": "Deny",
      "Principal": "*",
      "Action": ["Update:Replace", "Update:Delete"],
      "Resource": "*",
      "Condition": {
        "StringEquals": {
          "ResourceType": ["AWS::Amazon RDS::DBInstance"]
        }
      }
    },
    {
      "Effect": "Allow",
      "Principal": "*",
      "Action": "Update:*",
      "Resource": "*"
    }
  ]
}
```

**μ£Όμμ‚¬ν•­**:
- μ¤νƒ μ •μ±…μ€ ν• λ² μ„¤μ •ν•λ©΄ μ κ±°ν•  μ μ—†μµλ‹λ‹¤.
- μƒλ΅μ΄ μ •μ±…μΌλ΅ λ®μ–΄μ“°κ±°λ‚ μ—…λ°μ΄νΈ μ‹ μ„μ‹λ΅ μ¬μ •μν•  μ μμµλ‹λ‹¤.
- μ¤νƒ μ‚­μ λ” μ •μ±…κ³Ό λ¬΄κ΄€ν•κ² κ°€λ¥ν•©λ‹λ‹¤.

### DeletionPolicy μ†μ„±

**λ©μ **:
- μ¤νƒ μ‚­μ  μ‹ νΉμ • λ¦¬μ†μ¤μ λ™μ‘μ„ μ μ–΄ν•©λ‹λ‹¤.

**μµμ…**:
- `Delete` (κΈ°λ³Έκ°’): μ¤νƒκ³Ό ν•¨κ» λ¦¬μ†μ¤ μ‚­μ 
- `Retain`: λ¦¬μ†μ¤λ¥Ό λ³΄μ΅΄ν•κ³  μ¤νƒμ—μ„λ§ μ κ±°
- `Snapshot`: μ‚­μ  μ „ μ¤λƒ…μƒ· μƒμ„± (Amazon RDS, EBS λ“±)

**μμ‹**:
```yaml
Resources:
  MyDatabase:
    Type: AWS::Amazon RDS::DBInstance
    DeletionPolicy: Snapshot
    Properties:
      # ...

  MyBucket:
    Type: AWS::Amazon S3::Bucket
    DeletionPolicy: Retain
    Properties:
      # ...
```

### κµμ°¨ μ¤νƒ μ°Έμ΅° (Cross-Stack Reference)

**λ©μ **:
- μ—¬λ¬ μ¤νƒ κ°„μ— κ°’μ„ κ³µμ ν•©λ‹λ‹¤.
- μ¤νƒμ„ λ…Όλ¦¬μ μΌλ΅ λ¶„λ¦¬ν•λ©΄μ„λ„ μ—°κ²°ν•©λ‹λ‹¤.

**Export (λ‚΄λ³΄λ‚΄κΈ°)**:
```yaml
Outputs:
  VPCId:
    Description: Amazon VPC ID
    Value: !Ref Amazon VPC
    Export:
      Name: MyVPC-ID
```

**Import (κ°€μ Έμ¤κΈ°)**:
```yaml
Resources:
  MySubnet:
    Type: AWS::Amazon EC2::Subnet
    Properties:
      VpcId: !ImportValue MyVPC-ID
```

**μ¥μ **:
- λ„¤νΈμ›ν¬ μ¤νƒκ³Ό μ• ν”λ¦¬μΌ€μ΄μ… μ¤νƒμ„ λ¶„λ¦¬ν•  μ μμµλ‹λ‹¤.
- κ³µν†µ λ¦¬μ†μ¤λ¥Ό μ—¬λ¬ μ¤νƒμ—μ„ μ¬μ‚¬μ©ν•  μ μμµλ‹λ‹¤.
- μ¤νƒ κ°„ μμ΅΄μ„±μ„ λ…ν™•ν κ΄€λ¦¬ν•  μ μμµλ‹λ‹¤.

### μ¤‘μ²© μ¤νƒ (Nested Stacks)

**λ©μ **:
- λ³µμ΅ν• ν…ν”λ¦Ώμ„ μ—¬λ¬ κ°μ μ‘μ€ ν…ν”λ¦ΏμΌλ΅ λ¶„λ¦¬ν•©λ‹λ‹¤.
- μ¬μ‚¬μ© κ°€λ¥ν• ν…ν”λ¦Ώ μ»΄ν¬λ„νΈλ¥Ό λ§λ“­λ‹λ‹¤.

**μμ‹**:
```yaml
Resources:
  NetworkStack:
    Type: AWS::AWS CloudFormation::Stack
    Properties:
      TemplateURL: https://s3.amazonaws.com/bucket/network-template.yaml
      Parameters:
        VPCCidr: 10.0.0.0/16
```

**μ¥μ **:
- ν…ν”λ¦Ώ ν¬κΈ° μ ν• (51,200 bytes)μ„ μ°νν•  μ μμµλ‹λ‹¤.
- λ¨λ“ν™”λ μΈν”„λΌ κµ¬μ„±μ΄ κ°€λ¥ν•©λ‹λ‹¤.
- ν€ κ°„ ν‘μ—…μ΄ μ©μ΄ν•©λ‹λ‹¤.

### AWS CloudFormation λ¨λ²” μ‚¬λ΅€

**ν…ν”λ¦Ώ μ‘μ„±**:
- νλΌλ―Έν„°λ¥Ό ν™μ©ν•μ—¬ μ¬μ‚¬μ© κ°€λ¥ν• ν…ν”λ¦Ώμ„ μ‘μ„±ν•©λ‹λ‹¤.
- μ¶λ ¥κ°’μ„ λ…ν™•ν μ •μν•μ—¬ λ‹¤λ¥Έ μ¤νƒμ—μ„ μ°Έμ΅°ν•  μ μκ² ν•©λ‹λ‹¤.
- νƒκ·Έλ¥Ό μΌκ΄€λκ² μ‚¬μ©ν•μ—¬ λ¦¬μ†μ¤λ¥Ό κ΄€λ¦¬ν•©λ‹λ‹¤.
- μ„¤λ…μ„ μ¶”κ°€ν•μ—¬ ν…ν”λ¦Ώμ λ©μ μ„ λ…ν™•ν ν•©λ‹λ‹¤.

**μ¤νƒ κ΄€λ¦¬**:
- λ³€κ²½ μ„ΈνΈλ¥Ό μ‚¬μ©ν•μ—¬ μ—…λ°μ΄νΈ μ „ λ³€κ²½ μ‚¬ν•­μ„ ν™•μΈν•©λ‹λ‹¤.
- μ¤νƒ μ •μ±…μΌλ΅ μ¤‘μ” λ¦¬μ†μ¤λ¥Ό λ³΄νΈν•©λ‹λ‹¤.
- μ •κΈ°μ μΌλ΅ λ“λ¦¬ν”„νΈ κ°μ§€λ¥Ό μ‹¤ν–‰ν•©λ‹λ‹¤.
- ν…ν”λ¦Ώμ„ Git λ“±μ λ²„μ „ κ΄€λ¦¬ μ‹μ¤ν…μ— μ €μ¥ν•©λ‹λ‹¤.

**λ³΄μ•**:
- AWS IAM μ—­ν• μ„ μ‚¬μ©ν•μ—¬ μµμ† κ¶ν• μ›μΉ™μ„ μ μ©ν•©λ‹λ‹¤.
- AWS Secrets Managerλ‚ Parameter Storeλ¥Ό μ‚¬μ©ν•μ—¬ λ―Όκ°ν• μ •λ³΄λ¥Ό κ΄€λ¦¬ν•©λ‹λ‹¤.
- νΌλΈ”λ¦­ μ•΅μ„Έμ¤κ°€ ν•„μ” μ—†λ” λ¦¬μ†μ¤λ” ν”„λΌμ΄λΉ—μΌλ΅ μ μ§€ν•©λ‹λ‹¤.

**λΉ„μ© μµμ ν™”**:
- κ°λ° ν™κ²½μ€ ν•„μ”ν•  λ•λ§ μƒμ„±ν•κ³  μ‚¬μ© ν›„ μ‚­μ ν•©λ‹λ‹¤.
- λ¦¬μ†μ¤ νƒκ·Έλ¥Ό μ‚¬μ©ν•μ—¬ λΉ„μ©μ„ μ¶”μ ν•©λ‹λ‹¤.
- λ¶ν•„μ”ν• λ¦¬μ†μ¤λ” μ¦‰μ‹ μ‚­μ ν•©λ‹λ‹¤.
