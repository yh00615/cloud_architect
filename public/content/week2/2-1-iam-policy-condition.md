---
title: 'AWS IAM ì •ì±… Condition ìš”ì†Œ í™œìš©'
week: 2
session: 1
awsServices:
  - AWS IAM
learningObjectives:
  - AWS ì¸ì¦ê³¼ ê¶Œí•œì˜ ì°¨ì´ë¥¼ ì´í•´í•˜ê³ , IAMì„ í†µí•œ ì‚¬ìš©ì ì ‘ê·¼ ê´€ë¦¬ ë°©ë²•ì„ ì„¤ëª…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤
  - AWS IAM ì •ì±… êµ¬ì¡°ì™€ í‰ê°€ ë¡œì§ì„ ì„¤ëª…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤
  - Conditionê³¼ ê¶Œí•œ ê²½ê³„ë¥¼ í™œìš©í•œ ê³ ê¸‰ ê¶Œí•œ ì œì–´ ê¸°ë²•ì„ ì´í•´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤
  - AWS IAM ì—­í• ê³¼ ì„ì‹œ ìê²©ì¦ëª…ì˜ ë³´ì•ˆ ì´ì ì„ ì„¤ëª…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤
  - ì‹ ë¢° ì •ì±…ê³¼ ê¶Œí•œ ì •ì±…ì˜ ì°¨ì´ë¥¼ ì´í•´í•˜ê³  êµ¬ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤
  - AWS STS AssumeRoleë¡œ ì—­í• ì„ ì „í™˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤
  - AWS Organizationsì˜ ë©€í‹° ê³„ì • ê´€ë¦¬ ì „ëµì„ ì´í•´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤
prerequisites:
  - Week 1 ì™„ë£Œ
  - AWS IAM ì •ì±… ê¸°ë³¸ ë¬¸ë²• ì´í•´
  - JSON í˜•ì‹ ì´í•´
---

ì´ ì‹¤ìŠµì—ì„œëŠ” **AWS IAM Policyì˜ Condition ìš”ì†Œ**ë¥¼ í™œìš©í•˜ì—¬ **ì„¸ë°€í•œ ê¶Œí•œ ì œì–´**ë¥¼ êµ¬í˜„í•˜ëŠ” ë°©ë²•ì„ í•™ìŠµí•©ë‹ˆë‹¤.

ë¨¼ì € **í…ŒìŠ¤íŠ¸ìš© Amazon S3 ë²„í‚·**ì„ ìƒì„±í•˜ê³ , **MFA(Multi-Factor Authentication) ê¸°ë°˜ ì •ì±…**ì„ êµ¬í˜„í•˜ì—¬ ë¯¼ê°í•œ ì‘ì—…(ì‚­ì œ, ì“°ê¸°)ì—ëŠ” MFA ì¸ì¦ì„ í•„ìˆ˜ë¡œ ìš”êµ¬í•˜ë„ë¡ ì„¤ì •í•©ë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ **IP ì£¼ì†Œ ê¸°ë°˜ ì •ì±…**ì„ ì‘ì„±í•˜ì—¬ íŠ¹ì • IPì—ì„œë§Œ Amazon S3 ì ‘ê·¼ì„ í—ˆìš©í•©ë‹ˆë‹¤.

**ì‹œê°„ ê¸°ë°˜ ì •ì±…**ì„ ì‘ì„±í•˜ì—¬ íŠ¹ì • ê¸°ê°„ì—ë§Œ ë¦¬ì†ŒìŠ¤ ì ‘ê·¼ì„ í—ˆìš©í•˜ê³ , ë§ˆì§€ë§‰ìœ¼ë¡œ **ë³µí•© ì¡°ê±´**ì„ ì‚¬ìš©í•˜ì—¬ ì—¬ëŸ¬ ì¡°ê±´ì„ ì¡°í•©í•œ ê³ ê¸‰ ì •ì±…ì„ ì‘ì„±í•˜ë©°, **ìµœì†Œ ê¶Œí•œ ì›ì¹™**ê³¼ **Zero Trust ë³´ì•ˆ ëª¨ë¸**ì„ ì‹¤ë¬´ì— ì ìš©í•˜ëŠ” ë°©ë²•ì„ ìµí™ë‹ˆë‹¤.

> [!DOWNLOAD]
> [week2-1-iam-policy-condition.zip](/files/week2/week2-1-iam-policy-condition.zip)
>
> - `mfa-policy.json` - MFA ê°•ì œ ì •ì±… í…œí”Œë¦¿ (íƒœìŠ¤í¬ 2ì—ì„œ Amazon S3 ì“°ê¸° ì‘ì—… ì‹œ MFA ì¸ì¦ í•„ìˆ˜ ì •ì±… ì‘ì„± ì°¸ê³ )
> - `ip-restriction-policy.json` - IP ì œí•œ ì •ì±… í…œí”Œë¦¿ (íƒœìŠ¤í¬ 3ì—ì„œ íŠ¹ì • IP ë²”ìœ„ë§Œ Amazon S3 ì ‘ê·¼ í—ˆìš© ì •ì±… ì‘ì„± ì°¸ê³ )
> - `time-based-policy.json` - ì‹œê°„ ê¸°ë°˜ ì •ì±… í…œí”Œë¦¿ (íƒœìŠ¤í¬ 4ì—ì„œ íŠ¹ì • ê¸°ê°„ë§Œ Amazon S3 ì ‘ê·¼ í—ˆìš© ì •ì±… ì‘ì„± ì°¸ê³ )
> - `complex-condition-policy.json` - ë³µí•© ì¡°ê±´ ì •ì±… í…œí”Œë¦¿ (íƒœìŠ¤í¬ 5ì—ì„œ ì•”í˜¸í™”+IP+MFA ì¡°ê±´ ì¡°í•© ì •ì±… ì‘ì„± ì°¸ê³ )
> - `README.md` - ì •ì±… ì‚¬ìš© ë°©ë²• ë° Condition í‚¤ ë ˆí¼ëŸ°ìŠ¤
>
> **ê´€ë ¨ íƒœìŠ¤í¬:**
>
> - **íƒœìŠ¤í¬ 2: MFA ê°•ì œ ì •ì±… ìƒì„±**
>   mfa-policy.json íŒŒì¼ì„ ì°¸ê³ í•˜ì—¬ Amazon S3 ê°ì²´ ì‚­ì œ ë° ë²„í‚· ì‚­ì œ ì‘ì—… ì‹œ MFA ì¸ì¦ì„ í•„ìˆ˜ë¡œ ìš”êµ¬í•˜ëŠ” ì •ì±…ì„ ì‘ì„±í•˜ê³ , BoolIfExists ì¡°ê±´ì„ ì‚¬ìš©í•˜ì—¬ aws:MultiFactorAuthPresent í‚¤ë¡œ MFA ì¸ì¦ ì—¬ë¶€ë¥¼ í™•ì¸í•©ë‹ˆë‹¤
> - **íƒœìŠ¤í¬ 3: IP ì£¼ì†Œ ì œí•œ ì •ì±… ìƒì„±**
>   ip-restriction-policy.json íŒŒì¼ì„ ì°¸ê³ í•˜ì—¬ íŠ¹ì • IP ì£¼ì†Œ ë²”ìœ„(CIDR í‘œê¸°ë²•)ì—ì„œë§Œ Amazon S3 ë¦¬ì†ŒìŠ¤ì— ì ‘ê·¼í•  ìˆ˜ ìˆë„ë¡ ì œí•œí•˜ëŠ” ì •ì±…ì„ ì‘ì„±í•˜ê³ , IpAddressì™€ NotIpAddress ì¡°ê±´ì„ ì‚¬ìš©í•˜ì—¬ í—ˆìš©/ì°¨ë‹¨ IPë¥¼ ì„¤ì •í•©ë‹ˆë‹¤
> - **íƒœìŠ¤í¬ 4: ì‹œê°„ ê¸°ë°˜ ì •ì±… ìƒì„±**
>   time-based-policy.json íŒŒì¼ì„ ì°¸ê³ í•˜ì—¬ íŠ¹ì • ì‹œê°„ëŒ€(ì—…ë¬´ ì‹œê°„)ì—ë§Œ Amazon S3 ì“°ê¸° ì‘ì—…ì„ í—ˆìš©í•˜ëŠ” ì •ì±…ì„ ì‘ì„±í•˜ê³ , DateGreaterThanê³¼ DateLessThan ì¡°ê±´ì„ ì‚¬ìš©í•˜ì—¬ UTC ê¸°ì¤€ ì‹œê°„ ë²”ìœ„ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤
> - **ëª¨ë“  íƒœìŠ¤í¬: README.md ì°¸ê³ **
>   README.md íŒŒì¼ì—ì„œ AWS IAM Policy Condition í‚¤ ë ˆí¼ëŸ°ìŠ¤ì™€ ê° ì¡°ê±´ ì—°ì‚°ìì˜ ì‚¬ìš©ë²•ì„ ì°¸ê³ í•©ë‹ˆë‹¤

> [!COST]
> **ë¦¬ì†ŒìŠ¤ ìš´ì˜ ë¹„ìš© ê°€ì´ë“œ (ap-northeast-2 ê¸°ì¤€, ì˜¨ë””ë§¨ë“œ ìš”ê¸ˆ ê¸°ì¤€)**
>
> | ë¦¬ì†ŒìŠ¤ëª…       | íƒ€ì…/ì‚¬ì–‘ | IaC |              ë¹„ìš© |
> | -------------- | --------- | :-: | ----------------: |
> | AWS IAM        | ì‚¬ìš©ì    | âœ…  |              ë¬´ë£Œ |
> | AWS IAM        | ì •ì±…      | âŒ  |              ë¬´ë£Œ |
> | Amazon S3      | ë²„í‚·      | âŒ  |              ë¬´ë£Œ |
> | Amazon S3      | PUT ìš”ì²­  | âŒ  |  $0.005/1,000ìš”ì²­ |
> | Amazon S3      | GET ìš”ì²­  | âŒ  | $0.0004/1,000ìš”ì²­ |
> | AWS CloudShell | N/A       | N/A |              ë¬´ë£Œ |
>
> - **ì˜ˆìƒ ì‹¤ìŠµ ì‹œê°„**: 1-2ì‹œê°„
> - **ì˜ˆìƒ ì´ ë¹„ìš©**: ì•½ $0.01 ë¯¸ë§Œ (ì‹¤ìŠµ ê·œëª¨ 10-20íšŒ API í˜¸ì¶œ ê¸°ì¤€, ì‹¤ë¬´ í™˜ê²½ ì˜¨ë””ë§¨ë“œ ê¸°ì¤€)
>
> **ë¬´ë£Œ í”Œëœ**
>
> - ì´ ì‹¤ìŠµ ë¹„ìš©ì€ AWS ê°€ì… í›„ 6ê°œì›” ë‚´ ì œê³µë˜ëŠ” í¬ë ˆë”§ì—ì„œ ì°¨ê°ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
>
> **ë¦¬ì „ë³„ë¡œ ìš”ê¸ˆì´ ë‹¤ë¥¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìµœì‹  ìš”ê¸ˆì€ ì•„ë˜ ë§í¬ì—ì„œ í™•ì¸í•˜ì„¸ìš”.**
>
> ğŸ“˜ [AWS IAM ìš”ê¸ˆ](https://aws.amazon.com/iam/pricing/) | ğŸ“˜ [Amazon S3 ìš”ê¸ˆ](https://aws.amazon.com/s3/pricing/) | ğŸ§® [AWS ìš”ê¸ˆ ê³„ì‚°ê¸°](https://calculator.aws/)

> [!WARNING]
> ì´ ì‹¤ìŠµì—ì„œ ìƒì„±í•˜ëŠ” ì •ì±…ì€ ì‹¤ìŠµ ì¢…ë£Œ í›„ **ë°˜ë“œì‹œ ì‚­ì œí•´ì•¼ í•©ë‹ˆë‹¤**.

## íƒœìŠ¤í¬ 0: ì‹¤ìŠµ í™˜ê²½ êµ¬ì¶•

ì´ íƒœìŠ¤í¬ì—ì„œëŠ” CloudFormationì„ ì‚¬ìš©í•˜ì—¬ ì‹¤ìŠµì— í•„ìš”í•œ IAM ì‚¬ìš©ìì™€ Access Keyë¥¼ ìë™ìœ¼ë¡œ ìƒì„±í•©ë‹ˆë‹¤.

### í™˜ê²½ êµ¬ì„± ìš”ì†Œ

CloudFormation ìŠ¤íƒì€ ë‹¤ìŒ ë¦¬ì†ŒìŠ¤ë¥¼ ìƒì„±í•©ë‹ˆë‹¤:

- **IAM ì‚¬ìš©ì**: `lab-user` (ì •ì±… í…ŒìŠ¤íŠ¸ìš©)
- **Access Key**: AWS CLI ë° API í…ŒìŠ¤íŠ¸ìš©
- **ê¸°ë³¸ ì •ì±…**: S3 ë²„í‚· ëª©ë¡ ì¡°íšŒ ê¶Œí•œ

### ìƒì„¸ ë‹¨ê³„

1. ë‹¤ìš´ë¡œë“œí•œ `week2-1-iam-policy-condition.zip` íŒŒì¼ì˜ ì••ì¶•ì„ í•´ì œí•©ë‹ˆë‹¤.
2. `week2-1-iam-policy-condition.yaml` íŒŒì¼ì„ í™•ì¸í•©ë‹ˆë‹¤.
3. AWS Management Consoleì— ë¡œê·¸ì¸í•œ í›„ ìƒë‹¨ ê²€ìƒ‰ì°½ì—ì„œ `CloudFormation`ì„ ê²€ìƒ‰í•˜ê³  ì„ íƒí•©ë‹ˆë‹¤.
4. [[Create stack]] ë²„íŠ¼ì„ í´ë¦­í•©ë‹ˆë‹¤.
5. **Prerequisite - Prepare template**ì—ì„œ `Template is ready`ë¥¼ ì„ íƒí•©ë‹ˆë‹¤.
6. **Specify template**ì—ì„œ `Upload a template file`ì„ ì„ íƒí•©ë‹ˆë‹¤.
7. [[Choose file]] ë²„íŠ¼ì„ í´ë¦­í•œ í›„ `week2-1-iam-policy-condition.yaml` íŒŒì¼ì„ ì„ íƒí•©ë‹ˆë‹¤.
8. [[Next]] ë²„íŠ¼ì„ í´ë¦­í•©ë‹ˆë‹¤.
9. **Stack name**ì— `week2-1-iam-policy-stack`ì„ ì…ë ¥í•©ë‹ˆë‹¤.
10. **Parameters** ì„¹ì…˜ì—ì„œ ê¸°ë³¸ê°’ì„ í™•ì¸í•©ë‹ˆë‹¤ (ë³€ê²½ ë¶ˆí•„ìš”).
11. [[Next]] ë²„íŠ¼ì„ í´ë¦­í•©ë‹ˆë‹¤.
12. **Configure stack options** í˜ì´ì§€ì—ì„œ ê¸°ë³¸ê°’ì„ ìœ ì§€í•˜ê³  [[Next]] ë²„íŠ¼ì„ í´ë¦­í•©ë‹ˆë‹¤.
13. **Review** í˜ì´ì§€ì—ì„œ ì„¤ì •ì„ í™•ì¸í•©ë‹ˆë‹¤.
14. **Capabilities** ì„¹ì…˜ì—ì„œ `I acknowledge that AWS CloudFormation might create IAM resources`ë¥¼ ì²´í¬í•©ë‹ˆë‹¤.
15. [[Submit]] ë²„íŠ¼ì„ í´ë¦­í•©ë‹ˆë‹¤.
16. ìŠ¤íƒ ìƒì„±ì´ ì‹œì‘ë©ë‹ˆë‹¤. ìƒíƒœê°€ "CREATE_IN_PROGRESS"ë¡œ í‘œì‹œë©ë‹ˆë‹¤.

> [!NOTE]
> ìŠ¤íƒ ìƒì„±ì— 1-2ë¶„ì´ ì†Œìš”ë©ë‹ˆë‹¤. **Events** íƒ­ì—ì„œ IAM ì‚¬ìš©ìì™€ Access Keyê°€ ìƒì„±ë˜ëŠ” ê³¼ì •ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
> ëŒ€ê¸°í•˜ëŠ” ë™ì•ˆ ì´ì „ ì°¨ì‹œ ë‚´ìš©ì„ ë³µìŠµí•˜ê±°ë‚˜ ë‹¤ìŒ íƒœìŠ¤í¬ë¥¼ ë¯¸ë¦¬ ì½ì–´ë³´ì„¸ìš”.

17. ìƒíƒœê°€ "CREATE_COMPLETE"ë¡œ ë³€ê²½ë  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦½ë‹ˆë‹¤.
18. **Outputs** íƒ­ì„ ì„ íƒí•©ë‹ˆë‹¤.
19. ì¶œë ¥ê°’ë“¤ì„ í™•ì¸í•˜ê³  ë©”ëª¨ì¥ì— ë³µì‚¬í•©ë‹ˆë‹¤:
    - `LabUserName`: lab-user
    - `LabUserAccessKeyId`: AKIAë¡œ ì‹œì‘í•˜ëŠ” Access Key ID
    - `LabUserSecretAccessKey`: Secret Access Key (í•œ ë²ˆë§Œ í‘œì‹œë¨)

> [!IMPORTANT]
> ì´ ì¶œë ¥ê°’ë“¤ì€ íƒœìŠ¤í¬ 2-5ì—ì„œ ì •ì±… í…ŒìŠ¤íŠ¸ ì‹œ ì‚¬ìš©ë©ë‹ˆë‹¤. ë°˜ë“œì‹œ ë©”ëª¨ì¥ì— ì €ì¥í•˜ì„¸ìš”.

âœ… **íƒœìŠ¤í¬ ì™„ë£Œ**: ì‹¤ìŠµ í™˜ê²½ì´ ì¤€ë¹„ë˜ì—ˆìŠµë‹ˆë‹¤.

## íƒœìŠ¤í¬ 1: í…ŒìŠ¤íŠ¸ìš© Amazon S3 ë²„í‚· ìƒì„±

ì´ íƒœìŠ¤í¬ì—ì„œëŠ” **Condition ì •ì±…**ì„ í…ŒìŠ¤íŠ¸í•˜ê¸° ìœ„í•œ **Amazon S3 ë²„í‚·**ì„ ìƒì„±í•©ë‹ˆë‹¤. **Amazon S3 ë²„í‚·**ì€ ë‹¤ì–‘í•œ **Condition í‚¤**ë¥¼ ì§€ì›í•˜ë¯€ë¡œ ì •ì±… í…ŒìŠ¤íŠ¸ì— ì í•©í•©ë‹ˆë‹¤. **ë²„í‚· ì´ë¦„**ì€ ì „ ì„¸ê³„ì ìœ¼ë¡œ ê³ ìœ í•´ì•¼ í•˜ë¯€ë¡œ ë³¸ì¸ì˜ ì´ë¦„ì´ë‚˜ ê³ ìœ  ì‹ë³„ìë¥¼ ì¶”ê°€í•˜ì—¬ ìƒì„±í•©ë‹ˆë‹¤.

1. AWS Management Consoleì— ë¡œê·¸ì¸í•œ í›„ ìƒë‹¨ ê²€ìƒ‰ì°½ì—ì„œ `Amazon S3`ë¥¼ ê²€ìƒ‰í•˜ê³  ì„ íƒí•©ë‹ˆë‹¤.
2. [[Create bucket]] ë²„íŠ¼ì„ í´ë¦­í•©ë‹ˆë‹¤.
3. **Bucket name**ì— `iam-condition-lab-YOUR-INITIALS-12345`ë¥¼ ì…ë ¥í•©ë‹ˆë‹¤.

> [!TIP]
> **ì¤‘ìš”**: `YOUR-INITIALS`ë¥¼ ë³¸ì¸ì˜ ì´ë‹ˆì…œ(ì†Œë¬¸ì)ë¡œ, `12345`ë¥¼ ëœë¤ ìˆ«ìë¡œ ë³€ê²½í•©ë‹ˆë‹¤ (ì˜ˆ: `iam-condition-lab-jdoe-98765`). Amazon S3 ë²„í‚· ì´ë¦„ì€ ì†Œë¬¸ì, ìˆ«ì, í•˜ì´í”ˆ(-)ë§Œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. **ì´ ì´ë¦„ì„ ë©”ëª¨í•´ë‘¡ë‹ˆë‹¤.** ì´í›„ ì‹¤ìŠµì—ì„œ ë™ì¼í•œ ì´ë¦„ì„ ê³„ì† ì‚¬ìš©í•©ë‹ˆë‹¤.

4. **AWS Region**ì—ì„œ `Asia Pacific (Seoul) ap-northeast-2`ë¥¼ ì„ íƒí•©ë‹ˆë‹¤.
5. ë‚˜ë¨¸ì§€ ì„¤ì •ì€ ê¸°ë³¸ê°’ì„ ìœ ì§€í•©ë‹ˆë‹¤.
6. [[Create bucket]] ë²„íŠ¼ì„ í´ë¦­í•©ë‹ˆë‹¤.

> [!NOTE]
> ë²„í‚· ìƒì„±ì€ ì¦‰ì‹œ ì™„ë£Œë˜ë©° ë³„ë„ì˜ ëŒ€ê¸° ì‹œê°„ì´ ì—†ìŠµë‹ˆë‹¤. ë²„í‚· ëª©ë¡ í˜ì´ì§€ë¡œ ìë™ ì´ë™í•©ë‹ˆë‹¤.

7. ìƒì„±í•œ ë²„í‚·ì´ ëª©ë¡ì— í‘œì‹œë˜ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.
8. ë²„í‚· ì´ë¦„ ì˜†ì— **ë¦¬ì „**ì´ `ap-northeast-2`ë¡œ í‘œì‹œë˜ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.
9. ìƒì„±í•œ ë²„í‚·ì„ í´ë¦­í•©ë‹ˆë‹¤.
10. **Properties** íƒ­ì„ ì„ íƒí•©ë‹ˆë‹¤.
11. **Tags** ì„¹ì…˜ìœ¼ë¡œ ìŠ¤í¬ë¡¤í•©ë‹ˆë‹¤.
12. [[Edit]] ë²„íŠ¼ì„ í´ë¦­í•©ë‹ˆë‹¤.
13. [[Add tag]] ë²„íŠ¼ì„ í´ë¦­í•œ í›„ ë‹¤ìŒ íƒœê·¸ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤:

| Key         | Value     |
| ----------- | --------- |
| `Project`   | `AWS-Lab` |
| `Week`      | `2-1`     |
| `CreatedBy` | `Student` |

14. [[Save changes]] ë²„íŠ¼ì„ í´ë¦­í•©ë‹ˆë‹¤.

âœ… **íƒœìŠ¤í¬ ì™„ë£Œ**: í…ŒìŠ¤íŠ¸ìš© Amazon S3 ë²„í‚·ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.

## íƒœìŠ¤í¬ 2: MFA ê°•ì œ ì •ì±… ìƒì„±

ì´ íƒœìŠ¤í¬ì—ì„œëŠ” **MFA(Multi-Factor Authentication)** ì¸ì¦ì„ ìš”êµ¬í•˜ëŠ” ì •ì±…ì„ ìƒì„±í•©ë‹ˆë‹¤. **Condition ìš”ì†Œ**ì˜ **aws:MultiFactorAuthPresent** í‚¤ë¥¼ ì‚¬ìš©í•˜ë©´ ë¯¼ê°í•œ ì‘ì—…(ì‚­ì œ, ì“°ê¸°)ì— **MFA ì¸ì¦**ì„ í•„ìˆ˜ë¡œ ìš”êµ¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ì •ì±…ì€ **ë²„í‚· ëª©ë¡ ì¡°íšŒ**ëŠ” í—ˆìš©í•˜ì§€ë§Œ, **ê°ì²´ ì—…ë¡œë“œ**ë‚˜ **ì‚­ì œ**ëŠ” MFA ì¸ì¦ì´ ìˆì–´ì•¼ë§Œ ê°€ëŠ¥í•˜ë„ë¡ ì œí•œí•©ë‹ˆë‹¤.

> [!CONCEPT] BoolIfExists ì¡°ê±´ ì—°ì‚°ì
> **BoolIfExists**ëŠ” ì¡°ê±´ í‚¤ê°€ ìš”ì²­ ì»¨í…ìŠ¤íŠ¸ì— ì¡´ì¬í•˜ì§€ ì•Šì„ ë•Œë„ ì¡°ê±´ì„ í‰ê°€í•©ë‹ˆë‹¤. **aws:MultiFactorAuthPresent** í‚¤ëŠ” MFA ì¸ì¦ìœ¼ë¡œ ë¡œê·¸ì¸í–ˆì„ ë•Œë§Œ ìš”ì²­ì— í¬í•¨ë˜ë©°, IAM ì‚¬ìš©ìì˜ ì¥ê¸° ìê²©ì¦ëª…(Access Key)ìœ¼ë¡œ APIë¥¼ í˜¸ì¶œí•˜ë©´ ì´ í‚¤ ìì²´ê°€ ìš”ì²­ì— í¬í•¨ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
>
> **ì¥ê¸° ìê²©ì¦ëª… ì„¤ëª…**: IAM ì‚¬ìš©ìì˜ Access KeyëŠ” ë§Œë£Œë˜ì§€ ì•ŠëŠ” ì¥ê¸° ìê²©ì¦ëª…ì…ë‹ˆë‹¤. ì´ì™€ ë‹¬ë¦¬ AWS STS(Security Token Service)ë¡œ ë°œê¸‰ë°›ì€ ì„ì‹œ ìê²©ì¦ëª…ì€ ì„¸ì…˜ í† í°ê³¼ í•¨ê»˜ MFA ì •ë³´ë¥¼ í¬í•¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
>
> - **Bool**: í‚¤ê°€ ì—†ìœ¼ë©´ ì¡°ê±´ í‰ê°€ë¥¼ ê±´ë„ˆëœë‹ˆë‹¤ (Denyê°€ ì ìš©ë˜ì§€ ì•ŠìŒ)
> - **BoolIfExists**: í‚¤ê°€ ì—†ì–´ë„ ì¡°ê±´ì„ í‰ê°€í•©ë‹ˆë‹¤ (í‚¤ê°€ ì—†ìœ¼ë©´ falseë¡œ ê°„ì£¼í•˜ì—¬ Deny ì ìš©)
>
> ë”°ë¼ì„œ **BoolIfExists**ë¥¼ ì‚¬ìš©í•˜ë©´ MFA ì—†ì´ Access Keyë¡œ APIë¥¼ í˜¸ì¶œí•˜ëŠ” ê²½ìš°ì—ë„ Denyê°€ ì ìš©ë˜ì–´ ë³´ì•ˆì´ ê°•í™”ë©ë‹ˆë‹¤.

1. AWS IAM ì½˜ì†”ë¡œ ì´ë™í•©ë‹ˆë‹¤.
2. ì™¼ìª½ ë©”ë‰´ì—ì„œ **Policies**ë¥¼ ì„ íƒí•©ë‹ˆë‹¤.
3. [[Create policy]] ë²„íŠ¼ì„ í´ë¦­í•©ë‹ˆë‹¤.
4. **JSON** íƒ­ì„ ì„ íƒí•©ë‹ˆë‹¤.
5. ê¸°ì¡´ ì •ì±… ì½”ë“œë¥¼ ëª¨ë‘ ì‚­ì œí•œ í›„ ë‹¤ìŒ ì •ì±…ì„ ì…ë ¥í•©ë‹ˆë‹¤:
   ```json
   {
     "Version": "2012-10-17",
     "Statement": [
       {
         "Sid": "AllowListBucketWithoutMFA",
         "Effect": "Allow",
         "Action": [
           "s3:ListAllMyBuckets",
           "s3:ListBucket",
           "s3:GetBucketLocation"
         ],
         "Resource": "*"
       },
       {
         "Sid": "AllowS3WriteWithMFA",
         "Effect": "Allow",
         "Action": ["s3:PutObject", "s3:DeleteObject", "s3:DeleteBucket"],
         "Resource": "*",
         "Condition": {
           "BoolIfExists": {
             "aws:MultiFactorAuthPresent": "true"
           }
         }
       },
       {
         "Sid": "DenyS3ActionsWithoutMFA",
         "Effect": "Deny",
         "Action": ["s3:PutObject", "s3:DeleteObject", "s3:DeleteBucket"],
         "Resource": "*",
         "Condition": {
           "BoolIfExists": {
             "aws:MultiFactorAuthPresent": "false"
           }
         }
       }
     ]
   }
   ```
   > [!NOTE]
   > ì´ ì •ì±…ì€ ë²„í‚· ëª©ë¡ ì¡°íšŒëŠ” í—ˆìš©í•˜ê³ , ê°ì²´ ì—…ë¡œë“œ/ì‚­ì œëŠ” MFA ì¸ì¦ì´ ìˆì„ ë•Œë§Œ í—ˆìš©í•©ë‹ˆë‹¤. MFA ì—†ì´ ì“°ê¸° ì‘ì—…ì„ ì‹œë„í•˜ë©´ Denyê°€ ì ìš©ë©ë‹ˆë‹¤.
   >
   > **Allowì™€ Deny êµ¬ì¡° ì„¤ëª…**:
   >
   > - **AllowListBucketWithoutMFA** StatementëŠ” MFA ì—†ì´ë„ ë²„í‚· ëª©ë¡ ì¡°íšŒë¥¼ í—ˆìš©í•©ë‹ˆë‹¤.
   > - **AllowS3WriteWithMFA** StatementëŠ” MFAê°€ ìˆì„ ë•Œ Amazon S3 ì“°ê¸° ì‘ì—…ì„ í—ˆìš©í•©ë‹ˆë‹¤. ì´ Statementê°€ ì—†ìœ¼ë©´ condition-test-userëŠ” ë‹¤ë¥¸ Amazon S3 ê¶Œí•œì´ ì—†ìœ¼ë¯€ë¡œ MFAê°€ ìˆì–´ë„ ì“°ê¸° ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
   > - **DenyS3ActionsWithoutMFA** StatementëŠ” ë‹¤ë¥¸ ì •ì±…ì—ì„œ ë¶€ì—¬í•œ Amazon S3 ê¶Œí•œë„ MFA ì—†ì´ëŠ” ì°¨ë‹¨í•©ë‹ˆë‹¤.
   > - **DenyëŠ” í•­ìƒ Allowë³´ë‹¤ ìš°ì„ **í•˜ë¯€ë¡œ, ë‹¤ë¥¸ ì •ì±…ì´ s3:\*ë¥¼ í—ˆìš©í•˜ë”ë¼ë„ MFA ì—†ì´ëŠ” ì“°ê¸° ì‘ì—…ì´ ì°¨ë‹¨ë©ë‹ˆë‹¤.
   > - ì´ ì„¸ Statementë¥¼ í•¨ê»˜ ì‚¬ìš©í•˜ë©´ "MFAê°€ ìˆì„ ë•Œë§Œ Amazon S3 ì“°ê¸° ì‘ì—…ì´ ê°€ëŠ¥í•˜ë‹¤"ëŠ” ê°•ë ¥í•œ ì œí•œì„ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
   >
   > **ì´ ì‹¤ìŠµì˜ í…ŒìŠ¤íŠ¸ ì œí•œì‚¬í•­**: íƒœìŠ¤í¬ 7ì—ì„œëŠ” IAM ì‚¬ìš©ìì˜ Access Key(ì¥ê¸° ìê²©ì¦ëª…)ë¥¼ ì‚¬ìš©í•˜ë¯€ë¡œ MFA ì„¸ì…˜ì„ ì‹œë®¬ë ˆì´ì…˜í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ì´ ì‹¤ìŠµì—ì„œëŠ” "MFA ì—†ì´ ì“°ê¸° ì°¨ë‹¨"ë§Œ í…ŒìŠ¤íŠ¸í•˜ê³ , "MFA ìˆì„ ë•Œ ì“°ê¸° í—ˆìš©"ì€ í…ŒìŠ¤íŠ¸í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. MFA ìˆì„ ë•Œì˜ ë™ì‘ì„ í…ŒìŠ¤íŠ¸í•˜ë ¤ë©´ AWS ì½˜ì†”ì— MFA ì¸ì¦ìœ¼ë¡œ ë¡œê·¸ì¸í•œ í›„ Amazon S3 ì½˜ì†”ì—ì„œ ì§ì ‘ íŒŒì¼ì„ ì—…ë¡œë“œí•´ì•¼ í•©ë‹ˆë‹¤.
6. [[Next]] ë²„íŠ¼ì„ í´ë¦­í•©ë‹ˆë‹¤.
7. **Policy name**ì— `S3MFARequiredPolicy`ë¥¼ ì…ë ¥í•©ë‹ˆë‹¤.
8. **Description**ì— `Requires MFA for Amazon S3 write operations`ë¥¼ ì…ë ¥í•©ë‹ˆë‹¤.
9. **Tags - optional** ì„¹ì…˜ì—ì„œ [[Add new tag]] ë²„íŠ¼ì„ í´ë¦­í•œ í›„ ë‹¤ìŒ íƒœê·¸ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤:

| Key         | Value     |
| ----------- | --------- |
| `Project`   | `AWS-Lab` |
| `Week`      | `2-1`     |
| `CreatedBy` | `Student` |

10. [[Create policy]] ë²„íŠ¼ì„ í´ë¦­í•©ë‹ˆë‹¤.
11. ì •ì±… ìƒì„±ì´ ì™„ë£Œë˜ë©´ **Policies** í˜ì´ì§€ë¡œ ìë™ ì´ë™í•©ë‹ˆë‹¤.
12. í™”ë©´ ìƒë‹¨ì— ë…¹ìƒ‰ ë°°ë„ˆë¡œ "Policy S3MFARequiredPolicy has been created"ë¼ëŠ” ì„±ê³µ ë©”ì‹œì§€ê°€ í‘œì‹œë©ë‹ˆë‹¤.
13. ì •ì±… ëª©ë¡ì—ì„œ `S3MFARequiredPolicy`ë¥¼ ê²€ìƒ‰í•˜ì—¬ ìƒì„±ëœ ì •ì±…ì„ í™•ì¸í•©ë‹ˆë‹¤.

> [!NOTE]
> ì •ì±… ëª©ë¡ì—ì„œ **Policy name** ì—´ì— `S3MFARequiredPolicy`ê°€ í‘œì‹œë˜ê³ , **Type** ì—´ì— "Customer managed"ë¡œ í‘œì‹œë©ë‹ˆë‹¤. ì´ëŠ” ì‚¬ìš©ìê°€ ì§ì ‘ ìƒì„±í•œ ì •ì±…ì„ì„ ì˜ë¯¸í•©ë‹ˆë‹¤.

âœ… **íƒœìŠ¤í¬ ì™„ë£Œ**: MFA ê°•ì œ ì •ì±…ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.

## íƒœìŠ¤í¬ 3: IP ì£¼ì†Œ ì œí•œ ì •ì±… ìƒì„±

ì´ íƒœìŠ¤í¬ì—ì„œëŠ” **IP ì£¼ì†Œ ê¸°ë°˜ ì ‘ê·¼ ì œì–´** ì •ì±…ì„ ìƒì„±í•©ë‹ˆë‹¤. **aws:SourceIp** Condition í‚¤ë¥¼ ì‚¬ìš©í•˜ë©´ **íŠ¹ì • ë„¤íŠ¸ì›Œí¬**ì—ì„œë§Œ AWS ë¦¬ì†ŒìŠ¤ì— ì ‘ê·¼í•  ìˆ˜ ìˆë„ë¡ ì œí•œí•©ë‹ˆë‹¤. **CIDR í‘œê¸°ë²•**ì„ ì‚¬ìš©í•˜ì—¬ **IP ë²”ìœ„**ë¥¼ ì§€ì •í•˜ë©°, ì—¬ëŸ¬ IP ë²”ìœ„ë¥¼ ë°°ì—´ë¡œ ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ í†µí•´ íšŒì‚¬ ë„¤íŠ¸ì›Œí¬ë‚˜ **VPN IP ë²”ìœ„**ë§Œ í—ˆìš©í•˜ê³  ë‹¤ë¥¸ IPëŠ” ì°¨ë‹¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

> [!WARNING]
> **í•™êµ/íšŒì‚¬ ë„¤íŠ¸ì›Œí¬ IP ì œí•œ ì£¼ì˜ì‚¬í•­**: í•™êµë‚˜ íšŒì‚¬ ë„¤íŠ¸ì›Œí¬ì—ì„œ ì‹¤ìŠµí•˜ëŠ” ê²½ìš°, ë„¤íŠ¸ì›Œí¬ ê´€ë¦¬ìê°€ ì„¤ì •í•œ ë°©í™”ë²½ì´ë‚˜ í”„ë¡ì‹œë¡œ ì¸í•´ IP ê¸°ë°˜ ì •ì±…ì´ ì˜ˆìƒê³¼ ë‹¤ë¥´ê²Œ ë™ì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. íŠ¹íˆ NAT(Network Address Translation)ë¥¼ ì‚¬ìš©í•˜ëŠ” í™˜ê²½ì—ì„œëŠ” ì—¬ëŸ¬ ì‚¬ìš©ìê°€ ë™ì¼í•œ ê³µì¸ IPë¥¼ ê³µìœ í•˜ë¯€ë¡œ, ë³¸ì¸ì˜ IPë§Œ í—ˆìš©í•˜ë ¤ê³  í•´ë„ ê°™ì€ ë„¤íŠ¸ì›Œí¬ì˜ ë‹¤ë¥¸ ì‚¬ìš©ìë„ ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë˜í•œ í•™êµ/íšŒì‚¬ì—ì„œ íŠ¹ì • AWS ì„œë¹„ìŠ¤ë‚˜ í¬íŠ¸ë¥¼ ì°¨ë‹¨í•˜ëŠ” ê²½ìš° ì •ì±…ê³¼ ë¬´ê´€í•˜ê²Œ ì ‘ê·¼ì´ ë¶ˆê°€ëŠ¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ í™˜ê²½ì—ì„œëŠ” ê°œì¸ ë„¤íŠ¸ì›Œí¬(ì§‘, ì¹´í˜ ë“±)ì—ì„œ í…ŒìŠ¤íŠ¸í•˜ëŠ” ê²ƒì„ ê¶Œì¥í•©ë‹ˆë‹¤.

1. ìƒˆ ë¸Œë¼ìš°ì € íƒ­ì„ ì—½ë‹ˆë‹¤.
2. ì£¼ì†Œì°½ì— `https://checkip.amazonaws.com`ì„ ì…ë ¥í•˜ê³  Enterë¥¼ ëˆ„ë¦…ë‹ˆë‹¤.
3. í‘œì‹œëœ IP ì£¼ì†Œë¥¼ ë©”ëª¨ì¥ì— ë³µì‚¬í•©ë‹ˆë‹¤.

> [!IMPORTANT]
> ì´ IP ì£¼ì†ŒëŠ” ë‹¤ìŒ ë‹¨ê³„ì—ì„œ ì •ì±…ì— ì…ë ¥í•´ì•¼ í•©ë‹ˆë‹¤. ë°˜ë“œì‹œ ë©”ëª¨ì¥ì— ì €ì¥í•˜ì„¸ìš”.

4. AWS IAM ì½˜ì†” íƒ­ìœ¼ë¡œ ëŒì•„ê°‘ë‹ˆë‹¤.
5. [[Create policy]] ë²„íŠ¼ì„ ë‹¤ì‹œ í´ë¦­í•©ë‹ˆë‹¤.
6. **JSON** íƒ­ì„ ì„ íƒí•©ë‹ˆë‹¤.
7. ê¸°ì¡´ ì •ì±… ì½”ë“œë¥¼ ëª¨ë‘ ì‚­ì œí•œ í›„ ë‹¤ìŒ ì •ì±…ì„ ì…ë ¥í•©ë‹ˆë‹¤ (`YOUR_IP_ADDRESS`ë¥¼ ë©”ëª¨ì¥ì˜ IPë¡œ ë³€ê²½):

   ```json
   {
     "Version": "2012-10-17",
     "Statement": [
       {
         "Sid": "AllowFromSpecificIP",
         "Effect": "Allow",
         "Action": "s3:*",
         "Resource": "*",
         "Condition": {
           "IpAddress": {
             "aws:SourceIp": ["YOUR_IP_ADDRESS/32"]
           }
         }
       },
       {
         "Sid": "DenyFromOtherIPs",
         "Effect": "Deny",
         "Action": "s3:*",
         "Resource": "*",
         "Condition": {
           "NotIpAddress": {
             "aws:SourceIp": ["YOUR_IP_ADDRESS/32"]
           }
         }
       }
     ]
   }
   ```

> [!IMPORTANT]
> **í•„ìˆ˜ í™•ì¸**: `YOUR_IP_ADDRESS`ë¥¼ ì‹¤ì œ IP ì£¼ì†Œë¡œ ë³€ê²½í–ˆëŠ”ì§€ ë°˜ë“œì‹œ í™•ì¸í•˜ì„¸ìš”. í”Œë ˆì´ìŠ¤í™€ë”ë¥¼ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•˜ë©´ ëª¨ë“  Amazon S3 ì ‘ê·¼ì´ ì°¨ë‹¨ë©ë‹ˆë‹¤.
>
> **ì˜ˆì‹œ**: ë³¸ì¸ì˜ IPê°€ `1.2.3.4`ë¼ë©´ `"YOUR_IP_ADDRESS/32"`ë¥¼ `"1.2.3.4/32"`ë¡œ ë³€ê²½í•©ë‹ˆë‹¤.
>
> **CIDR í‘œê¸°ë²• ì„¤ëª…**: `/32`ëŠ” ë‹¨ì¼ IP ì£¼ì†Œë¥¼ ì˜ë¯¸í•©ë‹ˆë‹¤. ì—¬ëŸ¬ IPë¥¼ í—ˆìš©í•˜ë ¤ë©´ ë°°ì—´ë¡œ ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤: `["1.2.3.4/32", "5.6.7.8/32"]`

> [!NOTE]
> **Allowì™€ Deny êµ¬ì¡° ì„¤ëª…**:
>
> - **AllowFromSpecificIP** StatementëŠ” ì§€ì •ëœ IPì—ì„œì˜ Amazon S3 ì ‘ê·¼ì„ í—ˆìš©í•©ë‹ˆë‹¤.
> - **DenyFromOtherIPs** StatementëŠ” ë‹¤ë¥¸ ì •ì±…ì—ì„œ ë¶€ì—¬í•œ Amazon S3 ê¶Œí•œë„ ì§€ì •ëœ IP ì™¸ì—ì„œëŠ” ì°¨ë‹¨í•©ë‹ˆë‹¤.
> - **DenyëŠ” í•­ìƒ Allowë³´ë‹¤ ìš°ì„ **í•˜ë¯€ë¡œ, ë‹¤ë¥¸ ì •ì±…ì´ s3:\*ë¥¼ í—ˆìš©í•˜ë”ë¼ë„ IP ì™¸ë¶€ì—ì„œëŠ” ì°¨ë‹¨ë©ë‹ˆë‹¤.
> - ì´ ë‘ Statementë¥¼ í•¨ê»˜ ì‚¬ìš©í•˜ë©´ "ì´ IPì—ì„œë§Œ S3ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤"ëŠ” ê°•ë ¥í•œ ì œí•œì„ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

8. [[Next]] ë²„íŠ¼ì„ í´ë¦­í•©ë‹ˆë‹¤.
9. **Policy name**ì— `S3IPRestrictionPolicy`ë¥¼ ì…ë ¥í•©ë‹ˆë‹¤.
10. **Description**ì— `Restricts Amazon S3 access to specific IP addresses`ë¥¼ ì…ë ¥í•©ë‹ˆë‹¤.
11. **Tags - optional** ì„¹ì…˜ì—ì„œ [[Add new tag]] ë²„íŠ¼ì„ í´ë¦­í•œ í›„ ë‹¤ìŒ íƒœê·¸ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤:

| Key         | Value     |
| ----------- | --------- |
| `Project`   | `AWS-Lab` |
| `Week`      | `2-1`     |
| `CreatedBy` | `Student` |

12. [[Create policy]] ë²„íŠ¼ì„ í´ë¦­í•©ë‹ˆë‹¤.
13. ì •ì±… ìƒì„±ì´ ì™„ë£Œë˜ë©´ **Policies** í˜ì´ì§€ë¡œ ìë™ ì´ë™í•©ë‹ˆë‹¤.
14. í™”ë©´ ìƒë‹¨ì— ë…¹ìƒ‰ ë°°ë„ˆë¡œ "Policy S3IPRestrictionPolicy has been created"ë¼ëŠ” ì„±ê³µ ë©”ì‹œì§€ê°€ í‘œì‹œë©ë‹ˆë‹¤.
15. ì •ì±… ëª©ë¡ì—ì„œ `S3IPRestrictionPolicy`ë¥¼ ê²€ìƒ‰í•˜ì—¬ ìƒì„±ëœ ì •ì±…ì„ í™•ì¸í•©ë‹ˆë‹¤.

> [!NOTE]
> ì •ì±… ëª©ë¡ì—ì„œ **Policy name** ì—´ì— `S3IPRestrictionPolicy`ê°€ í‘œì‹œë˜ê³ , **Type** ì—´ì— "Customer managed"ë¡œ í‘œì‹œë©ë‹ˆë‹¤.

âœ… **íƒœìŠ¤í¬ ì™„ë£Œ**: IP ì£¼ì†Œ ì œí•œ ì •ì±…ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.

## íƒœìŠ¤í¬ 4: ì‹œê°„ ê¸°ë°˜ ì •ì±… ìƒì„±

ì´ íƒœìŠ¤í¬ì—ì„œëŠ” **ì‹œê°„ ê¸°ë°˜ ì •ì±…**ì„ ìƒì„±í•©ë‹ˆë‹¤. **aws:CurrentTime** Condition í‚¤ë¥¼ ì‚¬ìš©í•˜ì—¬ **íŠ¹ì • ê¸°ê°„**ì—ë§Œ ë¦¬ì†ŒìŠ¤ ì ‘ê·¼ì„ í—ˆìš©í•˜ë©°, **UTC ì‹œê°„ëŒ€**ë¥¼ ê¸°ì¤€ìœ¼ë¡œ í•©ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ **íŠ¹ì • ë‚ ì§œ ë²”ìœ„**ì—ë§Œ ë¯¼ê°í•œ ì‘ì—…ì„ í—ˆìš©í•˜ê³ , ê¸°ê°„ ì™¸ì—ëŠ” ì°¨ë‹¨í•˜ì—¬ **ë³´ì•ˆ**ì„ ê°•í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

> [!CONCEPT] aws:CurrentTime ì¡°ê±´ í‚¤ì™€ ì‹œê°„ëŒ€ ì²˜ë¦¬
> **aws:CurrentTime**ì€ ë‚ ì§œì™€ ì‹œê°„ì„ ëª¨ë‘ í¬í•¨í•œ ì „ì²´ íƒ€ì„ìŠ¤íƒ¬í”„ë¥¼ ë¹„êµí•©ë‹ˆë‹¤. ì´ ì •ì±…ì€ **íŠ¹ì • ê¸°ê°„**(ì˜ˆ: 2026ë…„ 1ì›” 1ì¼ë¶€í„° 12ì›” 31ì¼ê¹Œì§€)ì—ë§Œ ì ‘ê·¼ì„ í—ˆìš©í•˜ëŠ” ë° ì í•©í•©ë‹ˆë‹¤.
>
> **ì‹œê°„ëŒ€ ì²˜ë¦¬**:
>
> - AWS IAM ì •ì±…ì˜ ì‹œê°„ ì¡°ê±´ì€ í•­ìƒ **UTC(í˜‘ì • ì„¸ê³„ì‹œ)** ê¸°ì¤€ì…ë‹ˆë‹¤
> - í•œêµ­ ì‹œê°„(KST)ì€ UTC+9ì´ë¯€ë¡œ, í•œêµ­ ì‹œê°„ 09:00ëŠ” UTC 00:00ì…ë‹ˆë‹¤
> - ì˜ˆ: í•œêµ­ ì‹œê°„ 2026-01-01 09:00 â†’ UTC 2026-01-01 00:00
> - ì •ì±… ì‘ì„± ì‹œ ë°˜ë“œì‹œ UTCë¡œ ë³€í™˜í•˜ì—¬ ì…ë ¥í•´ì•¼ í•©ë‹ˆë‹¤
>
> **ë§¤ì¼ ë°˜ë³µë˜ëŠ” ì—…ë¬´ ì‹œê°„ ì œí•œì˜ í•œê³„**:
>
> - **aws:CurrentTime**ì€ íŠ¹ì • ë‚ ì§œ ë²”ìœ„ ì œí•œì— ì í•©í•©ë‹ˆë‹¤
> - ë§¤ì¼ ë°˜ë³µë˜ëŠ” ì‹œê°„ëŒ€ ì œí•œ(ì˜ˆ: ë§¤ì¼ 09:00-18:00)ì—ëŠ” ì í•©í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤
> - ì´ìœ : ë‚ ì§œì™€ ì‹œê°„ì„ í•¨ê»˜ ë¹„êµí•˜ë¯€ë¡œ, "ë§¤ì¼ 09:00-18:00"ì„ í‘œí˜„í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤
> - ëŒ€ì•ˆ: AWS Lambda í•¨ìˆ˜ + Amazon EventBridge ìŠ¤ì¼€ì¤„ëŸ¬, AWS Config ê·œì¹™, ë˜ëŠ” ì„œë“œíŒŒí‹° ì†”ë£¨ì…˜ ì‚¬ìš©
>
> **ì‹¤ë¬´ í™œìš© ì‹œë‚˜ë¦¬ì˜¤**:
>
> - âœ… í”„ë¡œì íŠ¸ ê¸°ê°„ ì œí•œ (2026-01-01 ~ 2026-12-31)
> - âœ… ì„ì‹œ ê³„ì•½ì§ ì§ì› ì ‘ê·¼ ê¸°ê°„ ì œí•œ
> - âœ… íŠ¹ì • ì´ë²¤íŠ¸ ê¸°ê°„ ë™ì•ˆë§Œ ë¦¬ì†ŒìŠ¤ ì ‘ê·¼ í—ˆìš©
> - âœ… ê°ì‚¬(Audit) ê¸°ê°„ ë™ì•ˆ íŠ¹ì • ì‘ì—… ì°¨ë‹¨
> - âŒ ë§¤ì¼ ì—…ë¬´ ì‹œê°„(09:00-18:00)ë§Œ ì ‘ê·¼ í—ˆìš© (ë¶ˆê°€ëŠ¥)

1. [[Create policy]] ë²„íŠ¼ì„ ë‹¤ì‹œ í´ë¦­í•©ë‹ˆë‹¤.
2. **JSON** íƒ­ì„ ì„ íƒí•©ë‹ˆë‹¤.
3. ê¸°ì¡´ ì •ì±… ì½”ë“œë¥¼ ëª¨ë‘ ì‚­ì œí•œ í›„ ë‹¤ìŒ ì •ì±…ì„ ì…ë ¥í•©ë‹ˆë‹¤ (`YYYY`ë¥¼ í˜„ì¬ ì—°ë„ë¡œ ë³€ê²½):
   ```json
   {
     "Version": "2012-10-17",
     "Statement": [
       {
         "Sid": "AllowDuringSpecificPeriod",
         "Effect": "Allow",
         "Action": "s3:*",
         "Resource": "*",
         "Condition": {
           "DateGreaterThan": {
             "aws:CurrentTime": "YYYY-01-01T00:00:00Z"
           },
           "DateLessThan": {
             "aws:CurrentTime": "YYYY-12-31T23:59:59Z"
           }
         }
       },
       {
         "Sid": "DenyOutsideSpecificPeriod",
         "Effect": "Deny",
         "Action": "s3:*",
         "Resource": "*",
         "Condition": {
           "DateLessThan": {
             "aws:CurrentTime": "YYYY-01-01T00:00:00Z"
           }
         }
       },
       {
         "Sid": "DenyAfterSpecificPeriod",
         "Effect": "Deny",
         "Action": "s3:*",
         "Resource": "*",
         "Condition": {
           "DateGreaterThan": {
             "aws:CurrentTime": "YYYY-12-31T23:59:59Z"
           }
         }
       }
     ]
   }
   ```

> [!IMPORTANT]
> **í•„ìˆ˜ í™•ì¸**: `YYYY`ë¥¼ í˜„ì¬ ì—°ë„ë¡œ ë³€ê²½í–ˆëŠ”ì§€ ë°˜ë“œì‹œ í™•ì¸í•˜ì„¸ìš”. í”Œë ˆì´ìŠ¤í™€ë”ë¥¼ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•˜ë©´ ì •ì±…ì´ ì‘ë™í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
>
> **ì˜ˆì‹œ**: 2026ë…„ì— ì‹¤ìŠµí•˜ëŠ” ê²½ìš° `YYYY-01-01T00:00:00Z`ë¥¼ `2026-01-01T00:00:00Z`ë¡œ, `YYYY-12-31T23:59:59Z`ë¥¼ `2026-12-31T23:59:59Z`ë¡œ ë³€ê²½í•©ë‹ˆë‹¤.

> [!NOTE]
> ì´ ì •ì±…ì€ ì§€ì •ëœ ì—°ë„(1ì›” 1ì¼ë¶€í„° 12ì›” 31ì¼ê¹Œì§€)ì—ë§Œ Amazon S3 ì ‘ê·¼ì„ í—ˆìš©í•©ë‹ˆë‹¤. ê¸°ê°„ ì™¸ì—ëŠ” ëª…ì‹œì  Denyë¡œ ëª¨ë“  Amazon S3 ì‘ì—…ì´ ì°¨ë‹¨ë©ë‹ˆë‹¤.
>
> **Allowì™€ Deny êµ¬ì¡° ì„¤ëª…**:
>
> - **AllowDuringSpecificPeriod** StatementëŠ” ì§€ì •ëœ ê¸°ê°„ ë‚´ì— Amazon S3 ì ‘ê·¼ì„ í—ˆìš©í•©ë‹ˆë‹¤.
> - **DenyOutsideSpecificPeriod**ì™€ **DenyAfterSpecificPeriod** StatementëŠ” ë‹¤ë¥¸ ì •ì±…ì—ì„œ ë¶€ì—¬í•œ Amazon S3 ê¶Œí•œë„ ê¸°ê°„ ì™¸ì—ëŠ” ì°¨ë‹¨í•©ë‹ˆë‹¤.
> - **DenyëŠ” í•­ìƒ Allowë³´ë‹¤ ìš°ì„ **í•˜ë¯€ë¡œ, ë‹¤ë¥¸ ì •ì±…ì´ s3:\*ë¥¼ í—ˆìš©í•˜ë”ë¼ë„ ê¸°ê°„ ì™¸ì—ëŠ” ì°¨ë‹¨ë©ë‹ˆë‹¤.
> - ì´ ì„¸ Statementë¥¼ í•¨ê»˜ ì‚¬ìš©í•˜ë©´ "ì´ ê¸°ê°„ì—ë§Œ Amazon S3ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤"ëŠ” ê°•ë ¥í•œ ì œí•œì„ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
>
> 4. [[Next]] ë²„íŠ¼ì„ í´ë¦­í•©ë‹ˆë‹¤.
> 5. **Policy name**ì— `S3TimeBasedPolicy`ë¥¼ ì…ë ¥í•©ë‹ˆë‹¤.
> 6. **Description**ì— `Restricts Amazon S3 access to specific date range`ë¥¼ ì…ë ¥í•©ë‹ˆë‹¤.
> 7. **Tags - optional** ì„¹ì…˜ì—ì„œ [[Add new tag]] ë²„íŠ¼ì„ í´ë¦­í•œ í›„ ë‹¤ìŒ íƒœê·¸ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤:

| Key         | Value     |
| ----------- | --------- |
| `Project`   | `AWS-Lab` |
| `Week`      | `2-1`     |
| `CreatedBy` | `Student` |

8. [[Create policy]] ë²„íŠ¼ì„ í´ë¦­í•©ë‹ˆë‹¤.
9. ì •ì±… ìƒì„±ì´ ì™„ë£Œë˜ë©´ **Policies** í˜ì´ì§€ë¡œ ìë™ ì´ë™í•©ë‹ˆë‹¤.
10. í™”ë©´ ìƒë‹¨ì— ë…¹ìƒ‰ ë°°ë„ˆë¡œ "Policy S3TimeBasedPolicy has been created"ë¼ëŠ” ì„±ê³µ ë©”ì‹œì§€ê°€ í‘œì‹œë©ë‹ˆë‹¤.
11. ì •ì±… ëª©ë¡ì—ì„œ `S3TimeBasedPolicy`ë¥¼ ê²€ìƒ‰í•˜ì—¬ ìƒì„±ëœ ì •ì±…ì„ í™•ì¸í•©ë‹ˆë‹¤.

> [!NOTE]
> ì •ì±… ëª©ë¡ì—ì„œ **Policy name** ì—´ì— `S3TimeBasedPolicy`ê°€ í‘œì‹œë˜ê³ , **Type** ì—´ì— "Customer managed"ë¡œ í‘œì‹œë©ë‹ˆë‹¤.

âœ… **íƒœìŠ¤í¬ ì™„ë£Œ**: ì‹œê°„ ê¸°ë°˜ ì •ì±…ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.

## íƒœìŠ¤í¬ 5: ë³µí•© ì¡°ê±´ ì •ì±… ìƒì„±

ì´ íƒœìŠ¤í¬ì—ì„œëŠ” **ë³µí•© ì¡°ê±´ ì •ì±…**ì„ ìƒì„±í•©ë‹ˆë‹¤. ì—¬ëŸ¬ **Condition í‚¤**ë¥¼ ë™ì‹œì— ì‚¬ìš©í•˜ì—¬ ë§¤ìš° ì„¸ë°€í•œ **ê¶Œí•œ ì œì–´**ë¥¼ êµ¬í˜„í•©ë‹ˆë‹¤. ëª¨ë“  ì¡°ê±´ì„ ë§Œì¡±í•´ì•¼ë§Œ ì ‘ê·¼ì´ í—ˆìš©ë˜ë¯€ë¡œ(**AND ì¡°ê±´**), **ì•”í˜¸í™” í•„ìˆ˜**, **IP ì œí•œ**, **MFA ì¸ì¦** ë“±ì„ ì¡°í•©í•˜ì—¬ **Zero Trust ë³´ì•ˆ ëª¨ë¸**ì„ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

> [!CONCEPT] ë³µí•© ì¡°ê±´ì˜ AND ì—°ì‚°
> í•˜ë‚˜ì˜ Condition ë¸”ë¡ ë‚´ì— ì—¬ëŸ¬ ì¡°ê±´ í‚¤ë¥¼ ë‚˜ì—´í•˜ë©´ **ëª¨ë“  ì¡°ê±´ì„ ë§Œì¡±í•´ì•¼** ì ‘ê·¼ì´ í—ˆìš©ë©ë‹ˆë‹¤(AND ì—°ì‚°). ì˜ˆë¥¼ ë“¤ì–´, ì•”í˜¸í™” í•„ìˆ˜ + IP ì œí•œ + MFA ì¸ì¦ì„ ëª¨ë‘ ë§Œì¡±í•´ì•¼ë§Œ Amazon S3 ì ‘ê·¼ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.

1. [[Create policy]] ë²„íŠ¼ì„ ë‹¤ì‹œ í´ë¦­í•©ë‹ˆë‹¤.
2. **JSON** íƒ­ì„ ì„ íƒí•©ë‹ˆë‹¤.
3. ê¸°ì¡´ ì •ì±… ì½”ë“œë¥¼ ëª¨ë‘ ì‚­ì œí•œ í›„ ë‹¤ìŒ ì •ì±…ì„ ì…ë ¥í•©ë‹ˆë‹¤ (`YOUR_IP_ADDRESS`ë¥¼ ì‹¤ì œ IPë¡œ ë³€ê²½):
   ```json
   {
     "Version": "2012-10-17",
     "Statement": [
       {
         "Sid": "AllowS3WithMultipleConditions",
         "Effect": "Allow",
         "Action": "s3:PutObject",
         "Resource": "arn:aws:s3:::iam-condition-lab-*/*",
         "Condition": {
           "StringEquals": {
             "s3:x-amz-server-side-encryption": "AES256"
           },
           "IpAddress": {
             "aws:SourceIp": "YOUR_IP_ADDRESS/32"
           },
           "BoolIfExists": {
             "aws:MultiFactorAuthPresent": "true"
           }
         }
       }
     ]
   }
   ```

> [!IMPORTANT]
> **í•„ìˆ˜ í™•ì¸**: `YOUR_IP_ADDRESS`ë¥¼ ì‹¤ì œ IP ì£¼ì†Œë¡œ ë³€ê²½í–ˆëŠ”ì§€ ë°˜ë“œì‹œ í™•ì¸í•˜ì„¸ìš”. í˜„ì¬ IPëŠ” `https://checkip.amazonaws.com`ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

> [!NOTE]
> ì´ ì •ì±…ì€ ì—¬ëŸ¬ ì¡°ê±´ì„ ë™ì‹œì— ë§Œì¡±í•´ì•¼ Amazon S3 ê°ì²´ ì—…ë¡œë“œê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤: ì•”í˜¸í™” í•„ìˆ˜(AES256), íŠ¹ì • IP ë²”ìœ„, MFA ì¸ì¦. ëª¨ë“  ì¡°ê±´ì´ AND ì—°ì‚°ìœ¼ë¡œ ê²°í•©ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

4. [[Next]] ë²„íŠ¼ì„ í´ë¦­í•©ë‹ˆë‹¤.
5. **Policy name**ì— `S3ComplexConditionPolicy`ë¥¼ ì…ë ¥í•©ë‹ˆë‹¤.
6. **Description**ì— `Amazon S3 access with multiple conditions`ë¥¼ ì…ë ¥í•©ë‹ˆë‹¤.
7. **Tags - optional** ì„¹ì…˜ì—ì„œ [[Add new tag]] ë²„íŠ¼ì„ í´ë¦­í•œ í›„ ë‹¤ìŒ íƒœê·¸ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤:

| Key         | Value     |
| ----------- | --------- |
| `Project`   | `AWS-Lab` |
| `Week`      | `2-1`     |
| `CreatedBy` | `Student` |

8. [[Create policy]] ë²„íŠ¼ì„ í´ë¦­í•©ë‹ˆë‹¤.
9. ì •ì±… ìƒì„±ì´ ì™„ë£Œë˜ë©´ **Policies** í˜ì´ì§€ë¡œ ìë™ ì´ë™í•©ë‹ˆë‹¤.
10. í™”ë©´ ìƒë‹¨ì— ë…¹ìƒ‰ ë°°ë„ˆë¡œ "Policy S3ComplexConditionPolicy has been created"ë¼ëŠ” ì„±ê³µ ë©”ì‹œì§€ê°€ í‘œì‹œë©ë‹ˆë‹¤.
11. ì •ì±… ëª©ë¡ì—ì„œ `S3ComplexConditionPolicy`ë¥¼ ê²€ìƒ‰í•˜ì—¬ ìƒì„±ëœ ì •ì±…ì„ í™•ì¸í•©ë‹ˆë‹¤.

> [!NOTE]
> ì •ì±… ëª©ë¡ì—ì„œ **Policy name** ì—´ì— `S3ComplexConditionPolicy`ê°€ í‘œì‹œë˜ê³ , **Type** ì—´ì— "Customer managed"ë¡œ í‘œì‹œë©ë‹ˆë‹¤. ì´ì œ 4ê°œì˜ Condition ì •ì±…ì´ ëª¨ë‘ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.

âœ… **íƒœìŠ¤í¬ ì™„ë£Œ**: ë³µí•© ì¡°ê±´ ì •ì±…ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.

## íƒœìŠ¤í¬ 6: í…ŒìŠ¤íŠ¸ìš© AWS IAM ì‚¬ìš©ì ìƒì„± ë° ì •ì±… ì—°ê²°

ì´ íƒœìŠ¤í¬ì—ì„œëŠ” ìƒì„±í•œ **Condition ì •ì±…**ë“¤ì„ ì‹¤ì œë¡œ í…ŒìŠ¤íŠ¸í•˜ê¸° ìœ„í•´ **í…ŒìŠ¤íŠ¸ìš© AWS IAM ì‚¬ìš©ì**ë¥¼ ìƒì„±í•©ë‹ˆë‹¤. ì´ ì‚¬ìš©ìì—ê²Œ **MFA ê°•ì œ ì •ì±…**ì„ ì—°ê²°í•˜ì—¬ ì •ì±…ì´ ì˜¬ë°”ë¥´ê²Œ ì‘ë™í•˜ëŠ”ì§€ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì‹¤ì œ í™˜ê²½ì—ì„œëŠ” ê¸°ì¡´ ì‚¬ìš©ìì—ê²Œ ì •ì±…ì„ ì—°ê²°í•˜ì§€ë§Œ, ì‹¤ìŠµì—ì„œëŠ” ì•ˆì „í•˜ê²Œ í…ŒìŠ¤íŠ¸í•˜ê¸° ìœ„í•´ ë³„ë„ì˜ ì‚¬ìš©ìë¥¼ ìƒì„±í•©ë‹ˆë‹¤.

1. ì™¼ìª½ ë©”ë‰´ì—ì„œ **Users**ë¥¼ ì„ íƒí•©ë‹ˆë‹¤.
2. [[Create user]] ë²„íŠ¼ì„ í´ë¦­í•©ë‹ˆë‹¤.
3. **User name**ì— `condition-test-user`ë¥¼ ì…ë ¥í•©ë‹ˆë‹¤.
4. **Provide user access to the AWS Management Console** ì²´í¬ë°•ìŠ¤ëŠ” ì²´í¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

> [!NOTE]
> ì´ ì‹¤ìŠµì—ì„œëŠ” AWS CLIë§Œ ì‚¬ìš©í•˜ë¯€ë¡œ ì½˜ì†” ë¡œê·¸ì¸ ê¶Œí•œì´ í•„ìš”í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. Access Keyë§Œ ìƒì„±í•˜ì—¬ CLIì—ì„œ ì‚¬ìš©í•©ë‹ˆë‹¤.
>
> **CloudShell ì‚¬ìš© ë°©ì‹ ì„¤ëª…**: íƒœìŠ¤í¬ 7ì—ì„œ AWS CloudShellì„ ì‚¬ìš©í•˜ì§€ë§Œ, CloudShellì€ í˜„ì¬ ë¡œê·¸ì¸í•œ ê´€ë¦¬ì ê³„ì •ì˜ ìê²©ì¦ëª…ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. condition-test-userì˜ ìê²©ì¦ëª…ì€ `--profile condition-test` ì˜µì…˜ìœ¼ë¡œ ë³„ë„ë¡œ ì§€ì •í•˜ì—¬ í…ŒìŠ¤íŠ¸í•˜ë¯€ë¡œ, condition-test-userì—ê²Œ ì½˜ì†” ì ‘ê·¼ ê¶Œí•œì´ í•„ìš”í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

5. [[Next]] ë²„íŠ¼ì„ í´ë¦­í•©ë‹ˆë‹¤.
6. **Attach policies directly**ë¥¼ ì„ íƒí•©ë‹ˆë‹¤.
7. ê²€ìƒ‰ì°½ì— `S3MFARequiredPolicy`ë¥¼ ì…ë ¥í•©ë‹ˆë‹¤.
8. ê²€ìƒ‰ ê²°ê³¼ì—ì„œ `S3MFARequiredPolicy` ì •ì±… ì™¼ìª½ì˜ ì²´í¬ë°•ìŠ¤ë¥¼ ì„ íƒí•©ë‹ˆë‹¤.

> [!NOTE]
> ì •ì±…ì´ ì„ íƒë˜ë©´ ì²´í¬ë°•ìŠ¤ì— ì²´í¬ í‘œì‹œê°€ ë‚˜íƒ€ë‚˜ê³ , í™”ë©´ í•˜ë‹¨ì— "1 policy selected"ë¼ê³  í‘œì‹œë©ë‹ˆë‹¤.

9. [[Next]] ë²„íŠ¼ì„ í´ë¦­í•©ë‹ˆë‹¤.
10. **Review and create** í˜ì´ì§€ì—ì„œ ì„¤ì •ì„ í™•ì¸í•©ë‹ˆë‹¤.
11. **User name**ì´ `condition-test-user`ì¸ì§€ í™•ì¸í•©ë‹ˆë‹¤.
12. **Permissions summary** ì„¹ì…˜ì—ì„œ `S3MFARequiredPolicy`ê°€ ì—°ê²°ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.
13. [[Create user]] ë²„íŠ¼ì„ í´ë¦­í•©ë‹ˆë‹¤.
14. ì‚¬ìš©ì ìƒì„±ì´ ì™„ë£Œë˜ë©´ **Users** í˜ì´ì§€ë¡œ ìë™ ì´ë™í•©ë‹ˆë‹¤.
15. í™”ë©´ ìƒë‹¨ì— ë…¹ìƒ‰ ë°°ë„ˆë¡œ "User condition-test-user created successfully"ë¼ëŠ” ì„±ê³µ ë©”ì‹œì§€ê°€ í‘œì‹œë©ë‹ˆë‹¤.
16. ì‚¬ìš©ì ëª©ë¡ì—ì„œ `condition-test-user`ë¥¼ ê²€ìƒ‰í•˜ì—¬ ìƒì„±ëœ ì‚¬ìš©ìë¥¼ í™•ì¸í•©ë‹ˆë‹¤.

> [!NOTE]
> ì‚¬ìš©ì ëª©ë¡ì—ì„œ **User name** ì—´ì— `condition-test-user`ê°€ í‘œì‹œë©ë‹ˆë‹¤. ì´ ì‚¬ìš©ìë¥¼ í´ë¦­í•˜ë©´ **Permissions** íƒ­ì—ì„œ `S3MFARequiredPolicy`ê°€ ì—°ê²°ë˜ì–´ ìˆëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

17. `condition-test-user` ìƒì„¸ í˜ì´ì§€ì—ì„œ **Tags** íƒ­ì„ ì„ íƒí•©ë‹ˆë‹¤.
18. [[Manage tags]] ë²„íŠ¼ì„ í´ë¦­í•©ë‹ˆë‹¤.
19. [[Add new tag]] ë²„íŠ¼ì„ í´ë¦­í•œ í›„ ë‹¤ìŒ íƒœê·¸ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤:

| Key         | Value     |
| ----------- | --------- |
| `Project`   | `AWS-Lab` |
| `Week`      | `2-1`     |
| `CreatedBy` | `Student` |

20. [[Save changes]] ë²„íŠ¼ì„ í´ë¦­í•©ë‹ˆë‹¤.

âœ… **íƒœìŠ¤í¬ ì™„ë£Œ**: í…ŒìŠ¤íŠ¸ìš© ì‚¬ìš©ìê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.

## íƒœìŠ¤í¬ 7: MFA ì •ì±… ë™ì‘ í…ŒìŠ¤íŠ¸

ì´ íƒœìŠ¤í¬ì—ì„œëŠ” ìƒì„±í•œ **MFA ê°•ì œ ì •ì±…**ì´ ì˜¬ë°”ë¥´ê²Œ ì‘ë™í•˜ëŠ”ì§€ í…ŒìŠ¤íŠ¸í•©ë‹ˆë‹¤. **condition-test-user**ì˜ **Access Key**ë¥¼ ìƒì„±í•˜ê³  **AWS CLI í”„ë¡œíŒŒì¼**ë¡œ êµ¬ì„±í•˜ì—¬, **MFA ì¸ì¦ ì—†ì´ëŠ” ê°ì²´ ì—…ë¡œë“œë‚˜ ì‚­ì œê°€ ì°¨ë‹¨**ë˜ëŠ” ê²ƒì„ í™•ì¸í•©ë‹ˆë‹¤.

### 7-1: Access Key ìƒì„±

1. AWS IAM ì½˜ì†”ë¡œ ì´ë™í•©ë‹ˆë‹¤.
2. ì™¼ìª½ ë©”ë‰´ì—ì„œ **Users**ë¥¼ ì„ íƒí•©ë‹ˆë‹¤.
3. ì‚¬ìš©ì ëª©ë¡ì—ì„œ `condition-test-user`ë¥¼ ê²€ìƒ‰í•©ë‹ˆë‹¤.
4. `condition-test-user`ë¥¼ í´ë¦­í•©ë‹ˆë‹¤.
5. **Security credentials** íƒ­ì„ ì„ íƒí•©ë‹ˆë‹¤.
6. **Access keys** ì„¹ì…˜ìœ¼ë¡œ ìŠ¤í¬ë¡¤í•©ë‹ˆë‹¤.
7. [[Create access key]] ë²„íŠ¼ì„ í´ë¦­í•©ë‹ˆë‹¤.
8. **Use case**ì—ì„œ `Command Line Interface (CLI)`ë¥¼ ì„ íƒí•©ë‹ˆë‹¤.

> [!NOTE]
> AWS ì½˜ì†”ì—ì„œ "We recommend that you don't create access keys for your root user or AWS IAM users. Instead, use AWS IAM Identity Center" ê°™ì€ ê¶Œì¥ ë©”ì‹œì§€ê°€ í‘œì‹œë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” AWSê°€ ì¥ê¸° ìê²©ì¦ëª…(Access Key) ëŒ€ì‹  AWS IAM Identity Center ì‚¬ìš©ì„ ê¶Œì¥í•˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. ì´ ì‹¤ìŠµì—ì„œëŠ” Condition ì •ì±… í•™ìŠµ ëª©ì ìœ¼ë¡œ Access Keyë¥¼ ì‚¬ìš©í•˜ë©°, ì‹¤ìŠµ ì¢…ë£Œ í›„ ë°˜ë“œì‹œ ì‚­ì œí•©ë‹ˆë‹¤.

9. í•˜ë‹¨ì˜ ì²´í¬ë°•ìŠ¤ `I understand the above recommendation and want to proceed to create an access key`ë¥¼ ì²´í¬í•©ë‹ˆë‹¤.
10. [[Next]] ë²„íŠ¼ì„ í´ë¦­í•©ë‹ˆë‹¤.
11. **Description tag**ì— `MFA policy test`ë¥¼ ì…ë ¥í•©ë‹ˆë‹¤.
12. [[Create access key]] ë²„íŠ¼ì„ í´ë¦­í•©ë‹ˆë‹¤.
13. **Access key** í˜ì´ì§€ê°€ í‘œì‹œë©ë‹ˆë‹¤.
14. **Access key**ì™€ **Secret access key** ê°’ì„ ë©”ëª¨ì¥ì— ë³µì‚¬í•©ë‹ˆë‹¤.

> [!IMPORTANT]
> Secret access keyëŠ” ì´ í™”ë©´ì—ì„œë§Œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë°˜ë“œì‹œ ë©”ëª¨ì¥ì— ì €ì¥í•˜ì„¸ìš”.

> [!WARNING]
> **ë³´ì•ˆ ì£¼ì˜ì‚¬í•­**: Access Keyì™€ Secret Access Keyë¥¼ í‰ë¬¸ ë©”ëª¨ì¥ì— ì €ì¥í•˜ëŠ” ê²ƒì€ ë³´ì•ˆ ìœ„í—˜ì´ ìˆìŠµë‹ˆë‹¤. ì‹¤ìŠµ ëª©ì ìœ¼ë¡œ ë¶ˆê°€í”¼í•˜ê²Œ ë©”ëª¨ì¥ì„ ì‚¬ìš©í•˜ì§€ë§Œ, ì‹¤ìŠµ ì¢…ë£Œ í›„ ë©”ëª¨ì¥ì˜ í‚¤ ì •ë³´ë¥¼ ë°˜ë“œì‹œ ì‚­ì œí•˜ì„¸ìš”. ì‹¤ë¬´ì—ì„œëŠ” AWS Secrets Managerë‚˜ ë¹„ë°€ë²ˆí˜¸ ê´€ë¦¬ì(1Password, LastPass ë“±)ë¥¼ ì‚¬ìš©í•˜ì—¬ ìê²©ì¦ëª…ì„ ì•ˆì „í•˜ê²Œ ì €ì¥í•´ì•¼ í•©ë‹ˆë‹¤.

15. [[Done]] ë²„íŠ¼ì„ í´ë¦­í•©ë‹ˆë‹¤.

### 7-2: AWS CLI í”„ë¡œíŒŒì¼ êµ¬ì„±

1. AWS Management Console ìƒë‹¨ ì˜¤ë¥¸ìª½ì˜ AWS CloudShell ì•„ì´ì½˜ì„ í´ë¦­í•©ë‹ˆë‹¤.

> [!NOTE]
> CloudShellì€ AWS CLIê°€ ì‚¬ì „ ì„¤ì¹˜ë˜ì–´ ìˆê³  í˜„ì¬ ë¡œê·¸ì¸í•œ AWS IAM ì‚¬ìš©ì ìê²©ì¦ëª…ì´ ìë™ìœ¼ë¡œ êµ¬ì„±ëœ ë¸Œë¼ìš°ì € ê¸°ë°˜ ì…¸ í™˜ê²½ì…ë‹ˆë‹¤. ì²« ì‹¤í–‰ ì‹œ í™˜ê²½ ì´ˆê¸°í™”ì— 1-2ë¶„ì´ ì†Œìš”ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

> [!WARNING]
> **AWS CloudShell ì„¸ì…˜ ì§€ì†ì„±**: AWS CloudShell ì„¸ì…˜ì€ ë¸Œë¼ìš°ì € íƒ­ì„ ë‹«ê±°ë‚˜ ì¼ì • ì‹œê°„(ì•½ 20ë¶„) ë™ì•ˆ í™œë™ì´ ì—†ìœ¼ë©´ ìë™ìœ¼ë¡œ ì¢…ë£Œë©ë‹ˆë‹¤. ì„¸ì…˜ì´ ì¢…ë£Œë˜ë©´ í™˜ê²½ ë³€ìˆ˜(AWS_ACCESS_KEY_ID ë“±)ë„ í•¨ê»˜ ì‚¬ë¼ì§‘ë‹ˆë‹¤. í•˜ì§€ë§Œ í™ˆ ë””ë ‰í† ë¦¬(/home/cloudshell-user)ì˜ íŒŒì¼ê³¼ AWS CLI í”„ë¡œíŒŒì¼ ì„¤ì •(~/.aws/config, ~/.aws/credentials)ì€ ìœ ì§€ë©ë‹ˆë‹¤. ë”°ë¼ì„œ ì´ íƒœìŠ¤í¬ì—ì„œ ì„¤ì •í•œ condition-test í”„ë¡œíŒŒì¼ì€ ì„¸ì…˜ì´ ì¢…ë£Œë˜ì–´ë„ ë³´ì¡´ë˜ë©°, ë‹¤ìŒì— CloudShellì„ ì—´ë©´ ë‹¤ì‹œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

2. ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ì—¬ condition-test-user í”„ë¡œíŒŒì¼ì„ êµ¬ì„±í•©ë‹ˆë‹¤:

```bash
aws configure --profile condition-test
```

3. í”„ë¡¬í”„íŠ¸ê°€ ë‚˜íƒ€ë‚˜ë©´ ë‹¤ìŒ ê°’ì„ ì…ë ¥í•©ë‹ˆë‹¤:
   - **AWS Access Key ID**: ë©”ëª¨ì¥ì— ì €ì¥í•œ Access Key ì…ë ¥
   - **AWS Secret Access Key**: ë©”ëª¨ì¥ì— ì €ì¥í•œ Secret Access Key ì…ë ¥
   - **Default region name**: `ap-northeast-2` ì…ë ¥
   - **Default output format**: `json` ì…ë ¥

> [!NOTE]
> ê° í•­ëª©ì„ ì…ë ¥í•œ í›„ Enter í‚¤ë¥¼ ëˆ„ë¦…ë‹ˆë‹¤.

### 7-3: MFA ì—†ì´ ê¶Œí•œ í…ŒìŠ¤íŠ¸

1. í˜„ì¬ ìê²©ì¦ëª…ì„ í™•ì¸í•©ë‹ˆë‹¤:

```bash
aws sts get-caller-identity --profile condition-test
```

> [!OUTPUT]
>
> ```json
> {
>   "UserId": "AIDAI...",
>   "Account": "123456789012",
>   "Arn": "arn:aws:iam::123456789012:user/condition-test-user"
> }
> ```

2. Amazon S3 ë²„í‚· ëª©ë¡ì„ ì¡°íšŒí•©ë‹ˆë‹¤ (ì½ê¸° ê¶Œí•œ - ì„±ê³µ ì˜ˆìƒ):

```bash
aws s3 ls --profile condition-test
```

> [!OUTPUT]
>
> ```
> YYYY-MM-DD HH:MM:SS iam-condition-lab-[ì´ë‹ˆì…œ]-[ìˆ«ì]
> ```

> [!NOTE]
> ë‚ ì§œì™€ ë²„í‚· ëª©ë¡ì€ ì‹¤ìŠµ í™˜ê²½ì— ë”°ë¼ ë‹¤ë¥¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë²„í‚· ëª©ë¡ ì¡°íšŒëŠ” MFA ì—†ì´ë„ ì„±ê³µí•©ë‹ˆë‹¤. S3MFARequiredPolicyì˜ AllowListBucketWithoutMFA Statementê°€ `s3:ListAllMyBuckets`, `s3:ListBucket`, `s3:GetBucketLocation` ì‘ì—…ì„ í—ˆìš©í•©ë‹ˆë‹¤.
>
> **ë³´ì•ˆ ê´€ì  ì„¤ëª…**: `s3:ListAllMyBuckets`ëŠ” `Resource: "*"`ë¡œ ì„¤ì •ë˜ì–´ ìˆì–´ ê³„ì • ë‚´ ëª¨ë“  ë²„í‚· ëª©ë¡ì„ ì¡°íšŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” AWS S3 ì„œë¹„ìŠ¤ì˜ ì„¤ê³„ìƒ ë²„í‚· ëª©ë¡ ì¡°íšŒëŠ” ê³„ì • ìˆ˜ì¤€ ì‘ì—…ì´ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. íƒœìŠ¤í¬ 1ì—ì„œ ìƒì„±í•œ ë²„í‚·ë¿ë§Œ ì•„ë‹ˆë¼ ê³„ì •ì— ì¡´ì¬í•˜ëŠ” ë‹¤ë¥¸ ë²„í‚·ë„ ëª¨ë‘ í‘œì‹œë©ë‹ˆë‹¤. íŠ¹ì • ë²„í‚·ë§Œ ë³´ì´ë„ë¡ ì œí•œí•˜ë ¤ë©´ ë²„í‚·ë³„ ì •ì±…ì´ë‚˜ IAM ê¶Œí•œ ê²½ê³„(Permission Boundary)ë¥¼ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤.

3. í…ŒìŠ¤íŠ¸ íŒŒì¼ì„ ìƒì„±í•©ë‹ˆë‹¤:

```bash
echo "test content" > test.txt
```

4. íƒœìŠ¤í¬ 1ì—ì„œ ìƒì„±í•œ ë²„í‚·ì— íŒŒì¼ ì—…ë¡œë“œë¥¼ ì‹œë„í•©ë‹ˆë‹¤ (ë³¸ì¸ì˜ ë²„í‚· ì´ë¦„ìœ¼ë¡œ ë³€ê²½):

```bash
aws s3 cp test.txt s3://iam-condition-lab-YOUR-INITIALS-12345/ --profile condition-test
```

> [!OUTPUT]
>
> ```
> An error occurred (AccessDenied) when calling the PutObject operation: Access Denied
> ```

> [!IMPORTANT]
> **AccessDenied** ì˜¤ë¥˜ê°€ ë‚˜ì™€ì•¼ ì •ìƒì…ë‹ˆë‹¤. ì´ëŠ” S3MFARequiredPolicyì˜ DenyS3ActionsWithoutMFA Statementê°€ MFA ì—†ëŠ” ì“°ê¸° ì‘ì—…ì„ ì°¨ë‹¨í–ˆìŒì„ ì˜ë¯¸í•©ë‹ˆë‹¤.

5. ë²„í‚·ì—ì„œ ê°ì²´ ì‚­ì œë¥¼ ì‹œë„í•©ë‹ˆë‹¤ (ì‹¤íŒ¨ ì˜ˆìƒ):

```bash
aws s3 rm s3://iam-condition-lab-YOUR-INITIALS-12345/test.txt --profile condition-test
```

> [!OUTPUT]
>
> ```
> An error occurred (AccessDenied) when calling the DeleteObject operation: Access Denied
> ```

> [!NOTE]
> ì‚­ì œ ì‘ì—…ë„ MFA ì—†ì´ëŠ” ì°¨ë‹¨ë©ë‹ˆë‹¤.
>
> **Amazon S3 ë³´ì•ˆ ì„¤ê³„ ì„¤ëª…**: ì´ì „ ë‹¨ê³„ì—ì„œ ì—…ë¡œë“œê°€ ì‹¤íŒ¨í–ˆìœ¼ë¯€ë¡œ `test.txt` ê°ì²´ëŠ” ë²„í‚·ì— ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ Amazon S3ëŠ” ê¶Œí•œì´ ì—†ëŠ” ìš”ì²­ì— ëŒ€í•´ ê°ì²´ ì¡´ì¬ ì—¬ë¶€ë¥¼ ë…¸ì¶œí•˜ì§€ ì•Šê¸° ìœ„í•´ í•­ìƒ `AccessDenied`ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤. ì´ëŠ” ë³´ì•ˆ ì„¤ê³„ì˜ ì¼ë¶€ë¡œ, ê¶Œí•œì´ ì—†ëŠ” ì‚¬ìš©ìê°€ ê°ì²´ì˜ ì¡´ì¬ ì—¬ë¶€ë¥¼ ì¶”ì¸¡í•˜ì§€ ëª»í•˜ë„ë¡ í•©ë‹ˆë‹¤. ë§Œì•½ ê¶Œí•œì´ ìˆëŠ” ìƒíƒœì—ì„œ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê°ì²´ë¥¼ ì‚­ì œí•˜ë ¤ê³  í•˜ë©´ `NoSuchKey` ë˜ëŠ” `404 Not Found` ì˜¤ë¥˜ê°€ ë°˜í™˜ë©ë‹ˆë‹¤.
>
> ì´ë¡œì¨ MFA ê°•ì œ ì •ì±…ì´ ì˜¬ë°”ë¥´ê²Œ ì‘ë™í•¨ì„ í™•ì¸í–ˆìŠµë‹ˆë‹¤.

âœ… **íƒœìŠ¤í¬ ì™„ë£Œ**: MFA ì •ì±…ì´ ì˜¬ë°”ë¥´ê²Œ ì‘ë™í•¨ì„ í™•ì¸í–ˆìŠµë‹ˆë‹¤.

## íƒœìŠ¤í¬ 8: IP ì œí•œ ì •ì±… ë™ì‘ í…ŒìŠ¤íŠ¸

ì´ íƒœìŠ¤í¬ì—ì„œëŠ” **IP ì£¼ì†Œ ê¸°ë°˜ ì ‘ê·¼ ì œì–´ ì •ì±…**ì´ ì˜¬ë°”ë¥´ê²Œ ì‘ë™í•˜ëŠ”ì§€ í…ŒìŠ¤íŠ¸í•©ë‹ˆë‹¤. íƒœìŠ¤í¬ 3ì—ì„œ í˜„ì¬ IPë¥¼ í—ˆìš© ëª©ë¡ì— ì¶”ê°€í–ˆìœ¼ë¯€ë¡œ, ì •ì±… ì—°ê²° í›„ ì ‘ê·¼ ì„±ê³µê³¼ ì°¨ë‹¨ì„ ëª¨ë‘ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### 8-1: IP ì œí•œ ì •ì±… ì—°ê²°

1. AWS IAM ì½˜ì†”ë¡œ ì´ë™í•©ë‹ˆë‹¤.
2. ì™¼ìª½ ë©”ë‰´ì—ì„œ **Users**ë¥¼ ì„ íƒí•©ë‹ˆë‹¤.
3. ì‚¬ìš©ì ëª©ë¡ì—ì„œ `condition-test-user`ë¥¼ ê²€ìƒ‰í•©ë‹ˆë‹¤.
4. `condition-test-user`ë¥¼ í´ë¦­í•©ë‹ˆë‹¤.
5. **Permissions** íƒ­ì„ ì„ íƒí•©ë‹ˆë‹¤.
6. **Add permissions** ë“œë¡­ë‹¤ìš´ì„ í´ë¦­í•œ í›„ `Attach policies directly`ë¥¼ ì„ íƒí•©ë‹ˆë‹¤.
7. ì •ì±… ê²€ìƒ‰ì°½ì— `S3IPRestrictionPolicy`ë¥¼ ì…ë ¥í•©ë‹ˆë‹¤.
8. `S3IPRestrictionPolicy` ì •ì±… ì™¼ìª½ì˜ ì²´í¬ë°•ìŠ¤ë¥¼ ì„ íƒí•©ë‹ˆë‹¤.
9. [[Next]] ë²„íŠ¼ì„ í´ë¦­í•©ë‹ˆë‹¤.
10. [[Add permissions]] ë²„íŠ¼ì„ í´ë¦­í•©ë‹ˆë‹¤.

> [!NOTE]
> ì´ì œ condition-test-userì—ëŠ” S3MFARequiredPolicyì™€ S3IPRestrictionPolicy ë‘ ê°œì˜ ì •ì±…ì´ ì—°ê²°ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

### 8-2: í˜„ì¬ IPì—ì„œ ì ‘ê·¼ í…ŒìŠ¤íŠ¸ (ì„±ê³µ ì˜ˆìƒ)

1. AWS CloudShellë¡œ ì´ë™í•©ë‹ˆë‹¤.
2. ë²„í‚· ëª©ë¡ ì¡°íšŒë¥¼ ì‹œë„í•©ë‹ˆë‹¤:

```bash
aws s3 ls --profile condition-test
```

> [!OUTPUT]
>
> ```
> YYYY-MM-DD HH:MM:SS iam-condition-lab-[ì´ë‹ˆì…œ]-[ìˆ«ì]
> ```

> [!NOTE]
> í˜„ì¬ IPê°€ íƒœìŠ¤í¬ 3ì—ì„œ í—ˆìš© ëª©ë¡ì— ì¶”ê°€ë˜ì—ˆìœ¼ë¯€ë¡œ ì ‘ê·¼ì´ ì„±ê³µí•©ë‹ˆë‹¤.

### 8-3: IP ì œí•œ ì •ì±… ë¶„ë¦¬

1. AWS IAM ì½˜ì†”ì˜ `condition-test-user` í˜ì´ì§€ë¡œ ëŒì•„ê°‘ë‹ˆë‹¤.
2. **Permissions** íƒ­ì—ì„œ `S3IPRestrictionPolicy` ì •ì±… ì˜¤ë¥¸ìª½ì˜ **X** ë²„íŠ¼ì„ í´ë¦­í•©ë‹ˆë‹¤.
3. í™•ì¸ ì°½ì—ì„œ [[Remove]] ë²„íŠ¼ì„ í´ë¦­í•©ë‹ˆë‹¤.

> [!NOTE]
> IP ì œí•œ ì •ì±… í…ŒìŠ¤íŠ¸ê°€ ì™„ë£Œë˜ì—ˆìœ¼ë¯€ë¡œ ì •ì±…ì„ ë¶„ë¦¬í•©ë‹ˆë‹¤. ì´ì œ condition-test-userì—ëŠ” S3MFARequiredPolicyë§Œ ë‚¨ì•„ìˆìŠµë‹ˆë‹¤.

âœ… **íƒœìŠ¤í¬ ì™„ë£Œ**: IP ì œí•œ ì •ì±…ì´ ì˜¬ë°”ë¥´ê²Œ ì‘ë™í•¨ì„ í™•ì¸í–ˆìŠµë‹ˆë‹¤.

## ë§ˆë¬´ë¦¬

ë‹¤ìŒì„ ì„±ê³µì ìœ¼ë¡œ ìˆ˜í–‰í–ˆìŠµë‹ˆë‹¤:

- AWS IAM Policyì˜ Condition ìš”ì†Œ êµ¬ì¡°ë¥¼ ì´í•´í–ˆìŠµë‹ˆë‹¤.
- MFA ê°•ì œ ì •ì±…ì„ ì‘ì„±í•˜ê³  í…ŒìŠ¤íŠ¸í–ˆìŠµë‹ˆë‹¤.
- IP ì£¼ì†Œ ê¸°ë°˜ ì ‘ê·¼ ì œì–´ ì •ì±…ì„ ì‘ì„±í•˜ê³  í…ŒìŠ¤íŠ¸í–ˆìŠµë‹ˆë‹¤.
- ì‹œê°„ ê¸°ë°˜ ì •ì±…ì„ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.
- ë³µí•© ì¡°ê±´ì„ ì‚¬ìš©í•˜ëŠ” ì •ì±…ì„ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.
- ë‹¤ì–‘í•œ Condition í‚¤ì˜ ì‚¬ìš©ë²•ì„ í•™ìŠµí–ˆìŠµë‹ˆë‹¤.

> [!NOTE]
> ì´ ì‹¤ìŠµì—ì„œëŠ” MFA ì •ì±…ê³¼ IP ì œí•œ ì •ì±…ì„ ì‹¤ì œë¡œ í…ŒìŠ¤íŠ¸í–ˆìŠµë‹ˆë‹¤. ì‹œê°„ ê¸°ë°˜ ì •ì±…ê³¼ ë³µí•© ì¡°ê±´ ì •ì±…ì€ ì •ì±… êµ¬ì¡°ë¥¼ í•™ìŠµí•˜ê¸° ìœ„í•´ ì‘ì„±í–ˆìœ¼ë©°, ì‹¤ì œ ë™ì‘ì„ í…ŒìŠ¤íŠ¸í•˜ë ¤ë©´ condition-test-userì— ê° ì •ì±…ì„ ìˆœì°¨ì ìœ¼ë¡œ ì—°ê²°/í•´ì œí•˜ë©° í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## ë¦¬ì†ŒìŠ¤ ì •ë¦¬

> [!WARNING]
> ë‹¤ìŒ ë‹¨ê³„ë¥¼ **ë°˜ë“œì‹œ ìˆ˜í–‰**í•˜ì—¬ ë¶ˆí•„ìš”í•œ ë¦¬ì†ŒìŠ¤ë¥¼ ì •ë¦¬í•©ë‹ˆë‹¤.

## 1ë‹¨ê³„: Tag Editorë¡œ ë¦¬ì†ŒìŠ¤ í™•ì¸

1. AWS Management Consoleì— ë¡œê·¸ì¸í•œ í›„ ìƒë‹¨ ê²€ìƒ‰ì°½ì—ì„œ `Resource Groups & Tag Editor`ë¥¼ ê²€ìƒ‰í•˜ê³  ì„ íƒí•©ë‹ˆë‹¤.
2. ì™¼ìª½ ë©”ë‰´ì—ì„œ **Tag Editor**ë¥¼ ì„ íƒí•©ë‹ˆë‹¤.
3. **Regions**ì—ì„œ `All regions`ë¥¼ ì„ íƒí•©ë‹ˆë‹¤.

> [!NOTE]
> AWS IAM ì‚¬ìš©ìì™€ ì •ì±…ì€ ê¸€ë¡œë²Œ ë¦¬ì†ŒìŠ¤ì´ë¯€ë¡œ `All regions`ë¥¼ ì„ íƒí•´ì•¼ ê²€ìƒ‰ ê²°ê³¼ì— í‘œì‹œë©ë‹ˆë‹¤.

4. **Resource types**ì—ì„œ `All supported resource types`ë¥¼ ì„ íƒí•©ë‹ˆë‹¤.
5. **Tags** ì„¹ì…˜ì—ì„œ ë‹¤ìŒì„ ì…ë ¥í•©ë‹ˆë‹¤:
   - **Tag key**: `Week`
   - **Tag value**: `2-1`
6. [[Search resources]] ë²„íŠ¼ì„ í´ë¦­í•©ë‹ˆë‹¤.
7. ì´ ì‹¤ìŠµì—ì„œ ìƒì„±í•œ Amazon S3 ë²„í‚· 1ê°œ, AWS IAM ì‚¬ìš©ì 1ê°œ, AWS IAM ì •ì±… 4ê°œê°€ í‘œì‹œë©ë‹ˆë‹¤.

> [!NOTE]
> Tag EditorëŠ” ë¦¬ì†ŒìŠ¤ë¥¼ ì°¾ëŠ” ìš©ë„ë¡œë§Œ ì‚¬ìš©ë©ë‹ˆë‹¤. ì‹¤ì œ ì‚­ì œëŠ” ë‹¤ìŒ ë‹¨ê³„ì—ì„œ ìˆ˜í–‰í•©ë‹ˆë‹¤.

## 2ë‹¨ê³„: Access Key ì‚­ì œ

1. AWS IAM ì½˜ì†”ë¡œ ì´ë™í•©ë‹ˆë‹¤.
2. ì™¼ìª½ ë©”ë‰´ì—ì„œ **Users**ë¥¼ ì„ íƒí•©ë‹ˆë‹¤.
3. ì‚¬ìš©ì ëª©ë¡ì—ì„œ `condition-test-user`ë¥¼ ê²€ìƒ‰í•©ë‹ˆë‹¤.
4. `condition-test-user`ë¥¼ í´ë¦­í•©ë‹ˆë‹¤.
5. **Security credentials** íƒ­ì„ ì„ íƒí•©ë‹ˆë‹¤.
6. **Access keys** ì„¹ì…˜ìœ¼ë¡œ ìŠ¤í¬ë¡¤í•©ë‹ˆë‹¤.
7. **Access keys** ì„¹ì…˜ì—ì„œ ìƒì„±í•œ Access Keyë¥¼ ì„ íƒí•©ë‹ˆë‹¤.
8. **Actions** > `Deactivate`ë¥¼ ì„ íƒí•©ë‹ˆë‹¤.
9. í™•ì¸ ì°½ì—ì„œ [[Deactivate]] ë²„íŠ¼ì„ í´ë¦­í•©ë‹ˆë‹¤.
10. **Actions** > `Delete`ë¥¼ ì„ íƒí•©ë‹ˆë‹¤.
11. í™•ì¸ ì°½ì—ì„œ [[Delete]] ë²„íŠ¼ì„ í´ë¦­í•©ë‹ˆë‹¤.

## 3ë‹¨ê³„: AWS CLI í”„ë¡œíŒŒì¼ ì‚­ì œ

1. AWS CloudShellë¡œ ì´ë™í•©ë‹ˆë‹¤.
2. ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ì—¬ condition-test í”„ë¡œíŒŒì¼ì´ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤:

```bash
aws configure list --profile condition-test
```

> [!NOTE]
> í”„ë¡œíŒŒì¼ì´ ì¡´ì¬í•˜ë©´ í”„ë¡œíŒŒì¼ ì •ë³´ê°€ í‘œì‹œë©ë‹ˆë‹¤. ë‹¤ìŒ ë‹¨ê³„ë¡œ ì§„í–‰í•˜ì—¬ í”„ë¡œíŒŒì¼ì„ ì‚­ì œí•©ë‹ˆë‹¤.

3. ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ì—¬ credentials íŒŒì¼ì—ì„œ í”„ë¡œíŒŒì¼ì„ ì‚­ì œí•©ë‹ˆë‹¤:

```bash
sed -i.bak '/^\[condition-test\]/,/^\[/{/^\[condition-test\]/d;/^\[/!d;}' ~/.aws/credentials
```

4. ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ì—¬ config íŒŒì¼ì—ì„œ í”„ë¡œíŒŒì¼ì„ ì‚­ì œí•©ë‹ˆë‹¤:

```bash
sed -i.bak '/^\[profile condition-test\]/,/^\[/{/^\[profile condition-test\]/d;/^\[/!d;}' ~/.aws/config
```

> [!NOTE]
> ì´ ëª…ë ¹ì–´ëŠ” ë‹¤ìŒ ì„¹ì…˜ í—¤ë”(`[`)ê°€ ë‚˜íƒ€ë‚  ë•Œê¹Œì§€ë§Œ ì‚­ì œí•˜ë¯€ë¡œ ë‹¤ë¥¸ í”„ë¡œíŒŒì¼ì´ ë³´ì¡´ë©ë‹ˆë‹¤. `.bak` íŒŒì¼ì€ ë°±ì—… íŒŒì¼ì…ë‹ˆë‹¤.

5. ì‚­ì œë¥¼ í™•ì¸í•©ë‹ˆë‹¤:

```bash
aws configure list --profile condition-test
```

> [!OUTPUT]
>
> ```
> The config profile (condition-test) could not be found
> ```

6. ë°±ì—… íŒŒì¼ì„ ì‚­ì œí•©ë‹ˆë‹¤:

```bash
rm ~/.aws/credentials.bak ~/.aws/config.bak
```

> [!NOTE]
> AWS CloudShellì˜ í™ˆ ë””ë ‰í† ë¦¬ëŠ” ì„¸ì…˜ ê°„ ìœ ì§€ë˜ë¯€ë¡œ, í”„ë¡œíŒŒì¼ì„ ì‚­ì œí•˜ì§€ ì•Šìœ¼ë©´ ë‹¤ìŒì— CloudShellì„ ì—´ì—ˆì„ ë•Œë„ condition-test í”„ë¡œíŒŒì¼ì´ ë‚¨ì•„ìˆìŠµë‹ˆë‹¤. ë³´ì•ˆì„ ìœ„í•´ ë°˜ë“œì‹œ ì‚­ì œí•´ì•¼ í•©ë‹ˆë‹¤.

## 4ë‹¨ê³„: AWS IAM ì‚¬ìš©ì ì‚­ì œ

1. AWS IAM ì½˜ì†”ë¡œ ì´ë™í•©ë‹ˆë‹¤.
2. ì™¼ìª½ ë©”ë‰´ì—ì„œ **Users**ë¥¼ ì„ íƒí•©ë‹ˆë‹¤.
3. ì‚¬ìš©ì ëª©ë¡ì—ì„œ `condition-test-user`ë¥¼ ê²€ìƒ‰í•©ë‹ˆë‹¤.
4. `condition-test-user`ë¥¼ ì„ íƒí•©ë‹ˆë‹¤.
5. [[Delete]] ë²„íŠ¼ì„ í´ë¦­í•©ë‹ˆë‹¤.
6. í™•ì¸ ì°½ì´ ë‚˜íƒ€ë‚˜ë©´ ì…ë ¥ í•„ë“œì— `condition-test-user`ë¥¼ ì…ë ¥í•©ë‹ˆë‹¤.

> [!NOTE]
> ì‚¬ìš©ì ì´ë¦„ì„ ì •í™•íˆ ì…ë ¥í•´ì•¼ [[Delete]] ë²„íŠ¼ì´ í™œì„±í™”ë©ë‹ˆë‹¤. ì‚¬ìš©ìë¥¼ ì‚­ì œí•˜ë©´ ì—°ê²°ëœ ì •ì±…ë„ ìë™ìœ¼ë¡œ ë¶„ë¦¬ë©ë‹ˆë‹¤.

7. [[Delete]] ë²„íŠ¼ì„ í´ë¦­í•©ë‹ˆë‹¤.
8. í™”ë©´ ìƒë‹¨ì— ë…¹ìƒ‰ ë°°ë„ˆë¡œ "User condition-test-user deleted successfully"ë¼ëŠ” ì„±ê³µ ë©”ì‹œì§€ê°€ í‘œì‹œë©ë‹ˆë‹¤.

## 5ë‹¨ê³„: AWS IAM ì •ì±… ì‚­ì œ

1. ì™¼ìª½ ë©”ë‰´ì—ì„œ **Policies**ë¥¼ ì„ íƒí•©ë‹ˆë‹¤.
2. ì •ì±… ëª©ë¡ì—ì„œ `S3MFARequiredPolicy`ë¥¼ ê²€ìƒ‰í•©ë‹ˆë‹¤.
3. `S3MFARequiredPolicy` ì •ì±… ì™¼ìª½ì˜ ë¼ë””ì˜¤ ë²„íŠ¼ì„ ì„ íƒí•©ë‹ˆë‹¤.

> [!NOTE]
> ì •ì±…ì´ ì„ íƒë˜ë©´ ë¼ë””ì˜¤ ë²„íŠ¼ì— ì ì´ í‘œì‹œë˜ê³ , ìƒë‹¨ì˜ **Actions** ë²„íŠ¼ì´ í™œì„±í™”ë©ë‹ˆë‹¤.

4. **Actions** > `Delete`ë¥¼ ì„ íƒí•©ë‹ˆë‹¤.
5. í™•ì¸ ì°½ì´ ë‚˜íƒ€ë‚˜ë©´ ì…ë ¥ í•„ë“œì— `S3MFARequiredPolicy`ë¥¼ ì…ë ¥í•©ë‹ˆë‹¤.
6. [[Delete]] ë²„íŠ¼ì„ í´ë¦­í•©ë‹ˆë‹¤.
7. í™”ë©´ ìƒë‹¨ì— ë…¹ìƒ‰ ë°°ë„ˆë¡œ "Policy S3MFARequiredPolicy deleted successfully"ë¼ëŠ” ì„±ê³µ ë©”ì‹œì§€ê°€ í‘œì‹œë©ë‹ˆë‹¤.
8. ë™ì¼í•œ ë°©ë²•ìœ¼ë¡œ ë‹¤ìŒ ì •ì±…ë“¤ì„ ê°ê° ì‚­ì œí•©ë‹ˆë‹¤:
   - `S3IPRestrictionPolicy`
   - `S3TimeBasedPolicy`
   - `S3ComplexConditionPolicy`

> [!NOTE]
> ê° ì •ì±… ì‚­ì œ ì‹œë§ˆë‹¤ ì •ì±… ì´ë¦„ì„ ì •í™•íˆ ì…ë ¥í•´ì•¼ í•©ë‹ˆë‹¤. 4ê°œì˜ ì •ì±…ì„ ëª¨ë‘ ì‚­ì œí•˜ë©´ ì •ì±… ëª©ë¡ì—ì„œ ë” ì´ìƒ í‘œì‹œë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

## 6ë‹¨ê³„: Amazon S3 ë²„í‚· ì‚­ì œ

1. Amazon S3 ì½˜ì†”ë¡œ ì´ë™í•©ë‹ˆë‹¤.
2. ë²„í‚· ëª©ë¡ì—ì„œ `iam-condition-lab-YOUR-INITIALS-12345` ë²„í‚·ì„ ê²€ìƒ‰í•©ë‹ˆë‹¤.
3. ë²„í‚· ì´ë¦„ ì™¼ìª½ì˜ ë¼ë””ì˜¤ ë²„íŠ¼ì„ ì„ íƒí•©ë‹ˆë‹¤.

> [!NOTE]
> íƒœìŠ¤í¬ 7ì—ì„œ íŒŒì¼ ì—…ë¡œë“œê°€ ì‹¤íŒ¨í–ˆìœ¼ë¯€ë¡œ ë²„í‚·ì€ ë¹„ì–´ìˆìŠµë‹ˆë‹¤. ë¹„ì–´ìˆëŠ” ë²„í‚·ì€ Empty ë‹¨ê³„ ì—†ì´ ë°”ë¡œ ì‚­ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë§Œì•½ ë²„í‚·ì— ê°ì²´ê°€ ìˆë‹¤ë©´ ë‹¤ìŒ ë‹¨ê³„(4-8)ë¥¼ ìˆ˜í–‰í•´ì•¼ í•©ë‹ˆë‹¤.

4. ë²„í‚·ì— ê°ì²´ê°€ ìˆëŠ” ê²½ìš°: [[Empty]] ë²„íŠ¼ì„ í´ë¦­í•©ë‹ˆë‹¤.
5. í™•ì¸ ì°½ì´ ë‚˜íƒ€ë‚˜ë©´ ì…ë ¥ í•„ë“œì— `permanently delete`ë¥¼ ì…ë ¥í•©ë‹ˆë‹¤.
6. [[Empty]] ë²„íŠ¼ì„ í´ë¦­í•©ë‹ˆë‹¤.
7. ë²„í‚· ë¹„ìš°ê¸°ê°€ ì‹œì‘ë©ë‹ˆë‹¤.
8. í™”ë©´ ìƒë‹¨ì— ë…¹ìƒ‰ ë°°ë„ˆë¡œ "Successfully emptied bucket"ì´ë¼ëŠ” ì„±ê³µ ë©”ì‹œì§€ê°€ í‘œì‹œë  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦½ë‹ˆë‹¤.
9. ë²„í‚· ëª©ë¡ì—ì„œ `iam-condition-lab-YOUR-INITIALS-12345` ë²„í‚·ì„ ë‹¤ì‹œ ì„ íƒí•©ë‹ˆë‹¤.
10. [[Delete]] ë²„íŠ¼ì„ í´ë¦­í•©ë‹ˆë‹¤.
11. í™•ì¸ ì°½ì´ ë‚˜íƒ€ë‚˜ë©´ ì…ë ¥ í•„ë“œì— ë²„í‚· ì´ë¦„ ì „ì²´ë¥¼ ì…ë ¥í•©ë‹ˆë‹¤.

> [!NOTE]
> ë²„í‚· ì´ë¦„ì„ ì •í™•íˆ ì…ë ¥í•´ì•¼ [[Delete bucket]] ë²„íŠ¼ì´ í™œì„±í™”ë©ë‹ˆë‹¤.

12. [[Delete bucket]] ë²„íŠ¼ì„ í´ë¦­í•©ë‹ˆë‹¤.
13. í™”ë©´ ìƒë‹¨ì— ë…¹ìƒ‰ ë°°ë„ˆë¡œ "Successfully deleted bucket"ì´ë¼ëŠ” ì„±ê³µ ë©”ì‹œì§€ê°€ í‘œì‹œë©ë‹ˆë‹¤.
14. ë²„í‚· ëª©ë¡ì—ì„œ í•´ë‹¹ ë²„í‚·ì´ ë” ì´ìƒ í‘œì‹œë˜ì§€ ì•ŠëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.

âœ… **ì‹¤ìŠµ ì¢…ë£Œ**: ëª¨ë“  ë¦¬ì†ŒìŠ¤ê°€ ì •ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤.

## ì¶”ê°€ í•™ìŠµ ë¦¬ì†ŒìŠ¤

- [AWS IAM JSON ì •ì±… ìš”ì†Œ: Condition](https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_elements_condition.html)
- [AWS ì „ì—­ ì¡°ê±´ ì»¨í…ìŠ¤íŠ¸ í‚¤](https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_condition-keys.html)
- [AWS IAM ì •ì±… ì˜ˆì œ](https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_examples.html)

## ğŸ“š ì°¸ê³ : Condition í‚¤ ì¢…ë¥˜

ë‹¤ìŒì€ ìì£¼ ì‚¬ìš©ë˜ëŠ” Condition í‚¤ë“¤ì…ë‹ˆë‹¤:

### ë¬¸ìì—´ ì¡°ê±´(String Conditions)

```json
"Condition": {
  "StringEquals": {
    "s3:x-amz-server-side-encryption": "AES256"
  },
  "StringLike": {
    "s3:prefix": "documents/*"
  }
}
```

### ìˆ«ì ì¡°ê±´(Numeric Conditions)

```json
"Condition": {
  "NumericLessThan": {
    "s3:max-keys": "100"
  },
  "NumericGreaterThanEquals": {
    "aws:MultiFactorAuthAge": "3600"
  }
}
```

### ë‚ ì§œ/ì‹œê°„ ì¡°ê±´(Date/Time Conditions)

```json
"Condition": {
  "DateGreaterThan": {
    "aws:CurrentTime": "2026-01-01T00:00:00Z"
  },
  "DateLessThan": {
    "aws:CurrentTime": "2026-12-31T23:59:59Z"
  }
}
```

### Boolean ì¡°ê±´(Boolean Conditions)

```json
"Condition": {
  "BoolIfExists": {
    "aws:SecureTransport": "true",
    "aws:MultiFactorAuthPresent": "true"
  }
}
```

> [!NOTE]
> íƒœìŠ¤í¬ 2ì—ì„œ ì„¤ëª…í•œ ê²ƒì²˜ëŸ¼, **aws:MultiFactorAuthPresent** í‚¤ëŠ” **BoolIfExists**ë¥¼ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤. **Bool**ì„ ì‚¬ìš©í•˜ë©´ í‚¤ê°€ ì—†ì„ ë•Œ ì¡°ê±´ í‰ê°€ë¥¼ ê±´ë„ˆë›°ë¯€ë¡œ ë³´ì•ˆì´ ì•½í™”ë©ë‹ˆë‹¤.

### IP ì£¼ì†Œ ì¡°ê±´(IP Address Conditions)

```json
"Condition": {
  "IpAddress": {
    "aws:SourceIp": [
      "203.0.113.0/24",   // ì˜ˆì‹œ IP (RFC 5737 ë¬¸ì„œìš©)
      "198.51.100.0/24"   // ì‹¤ì œ ì‚¬ìš© ì‹œ ë³¸ì¸ì˜ IPë¡œ ë³€ê²½
    ]
  },
  "NotIpAddress": {
    "aws:SourceIp": "192.0.2.0/24"  // ì˜ˆì‹œ IP (RFC 5737 ë¬¸ì„œìš©)
  }
}
```

> [!NOTE]
> ìœ„ ì˜ˆì‹œì˜ IP ì£¼ì†ŒëŠ” RFC 5737 ë¬¸ì„œìš© ì˜ˆì‹œ IPì…ë‹ˆë‹¤. ì‹¤ì œ ì •ì±… ì‘ì„± ì‹œ ë³¸ì¸ì˜ IP ì£¼ì†Œë¡œ ë³€ê²½í•´ì•¼ í•©ë‹ˆë‹¤.

### ì‹œê°„ ê¸°ë°˜ ì ‘ê·¼ ì œì–´ ì‹¤ë¬´ í™œìš©

#### 1. í”„ë¡œì íŠ¸ ê¸°ê°„ ì œí•œ

**ì‹œë‚˜ë¦¬ì˜¤**: ì™¸ë¶€ ì»¨ì„¤í„´íŠ¸ì—ê²Œ í”„ë¡œì íŠ¸ ê¸°ê°„(3ê°œì›”)ë§Œ AWS ë¦¬ì†ŒìŠ¤ ì ‘ê·¼ ê¶Œí•œ ë¶€ì—¬

```json
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Action": "*",
      "Resource": "*",
      "Condition": {
        "DateGreaterThan": {
          "aws:CurrentTime": "2026-01-01T00:00:00Z"
        },
        "DateLessThan": {
          "aws:CurrentTime": "2026-03-31T23:59:59Z"
        }
      }
    }
  ]
}
```

**ì¥ì **: í”„ë¡œì íŠ¸ ì¢…ë£Œ í›„ ìˆ˜ë™ìœ¼ë¡œ ê¶Œí•œì„ íšŒìˆ˜í•  í•„ìš” ì—†ì´ ìë™ìœ¼ë¡œ ì ‘ê·¼ì´ ì°¨ë‹¨ë©ë‹ˆë‹¤.

#### 2. ì„ì‹œ ê³„ì•½ì§ ì§ì› ì ‘ê·¼ ì œí•œ

**ì‹œë‚˜ë¦¬ì˜¤**: 6ê°œì›” ê³„ì•½ì§ ì§ì›ì—ê²Œ ê³„ì•½ ê¸°ê°„ ë™ì•ˆë§Œ íŠ¹ì • Amazon S3 ë²„í‚· ì ‘ê·¼ í—ˆìš©

```json
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Action": ["s3:GetObject", "s3:PutObject", "s3:ListBucket"],
      "Resource": [
        "arn:aws:s3:::project-bucket",
        "arn:aws:s3:::project-bucket/*"
      ],
      "Condition": {
        "DateGreaterThan": {
          "aws:CurrentTime": "2026-01-01T00:00:00Z"
        },
        "DateLessThan": {
          "aws:CurrentTime": "2026-06-30T23:59:59Z"
        }
      }
    }
  ]
}
```

**ëª¨ë²” ì‚¬ë¡€**: ê³„ì•½ ì¢…ë£Œì¼ë³´ë‹¤ 1-2ì¼ ì—¬ìœ ë¥¼ ë‘ê³  ì„¤ì •í•˜ì—¬ ì—…ë¬´ ì¸ìˆ˜ì¸ê³„ ì‹œê°„ì„ í™•ë³´í•©ë‹ˆë‹¤.

#### 3. ì´ë²¤íŠ¸ ê¸°ê°„ í•œì • ë¦¬ì†ŒìŠ¤ ì ‘ê·¼

**ì‹œë‚˜ë¦¬ì˜¤**: ë¸”ë™ í”„ë¼ì´ë°ì´ ì´ë²¤íŠ¸ ê¸°ê°„(11ì›” í•œ ë‹¬)ë§Œ ë§ˆì¼€íŒ… íŒ€ì—ê²Œ í”„ë¡œëª¨ì…˜ Lambda í•¨ìˆ˜ ì‹¤í–‰ ê¶Œí•œ ë¶€ì—¬

```json
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Action": ["lambda:InvokeFunction"],
      "Resource": "arn:aws:lambda:ap-northeast-2:*:function:BlackFridayPromotion",
      "Condition": {
        "DateGreaterThan": {
          "aws:CurrentTime": "2026-11-01T00:00:00Z"
        },
        "DateLessThan": {
          "aws:CurrentTime": "2026-11-30T23:59:59Z"
        }
      }
    }
  ]
}
```

**ì¥ì **: ì´ë²¤íŠ¸ ì¢…ë£Œ í›„ ìë™ìœ¼ë¡œ ê¶Œí•œì´ íšŒìˆ˜ë˜ì–´ ë³´ì•ˆ ìœ„í—˜ì„ ìµœì†Œí™”í•©ë‹ˆë‹¤.

#### 4. ê°ì‚¬ ê¸°ê°„ ë™ì•ˆ ì‚­ì œ ì‘ì—… ì°¨ë‹¨

**ì‹œë‚˜ë¦¬ì˜¤**: ì—°ë§ ê°ì‚¬ ê¸°ê°„(12ì›” 1ì¼~31ì¼) ë™ì•ˆ ëª¨ë“  ì‚­ì œ ì‘ì—… ì°¨ë‹¨

```json
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Deny",
      "Action": [
        "s3:DeleteObject",
        "s3:DeleteBucket",
        "dynamodb:DeleteTable",
        "rds:DeleteDBInstance"
      ],
      "Resource": "*",
      "Condition": {
        "DateGreaterThan": {
          "aws:CurrentTime": "2026-12-01T00:00:00Z"
        },
        "DateLessThan": {
          "aws:CurrentTime": "2026-12-31T23:59:59Z"
        }
      }
    }
  ]
}
```

**ì¤‘ìš”**: DenyëŠ” ëª¨ë“  Allowë³´ë‹¤ ìš°ì„ í•˜ë¯€ë¡œ, ê´€ë¦¬ì ê¶Œí•œì´ ìˆì–´ë„ ê°ì‚¬ ê¸°ê°„ì—ëŠ” ì‚­ì œê°€ ì°¨ë‹¨ë©ë‹ˆë‹¤.

#### 5. ì‹œê°„ëŒ€ ë³€í™˜ ì˜ˆì‹œ

**í•œêµ­ ì‹œê°„(KST)ì„ UTCë¡œ ë³€í™˜í•˜ëŠ” ë°©ë²•**:

| í•œêµ­ ì‹œê°„ (KST, UTC+9) | UTC ì‹œê°„         | ì •ì±…ì— ì…ë ¥í•  ê°’       |
| ---------------------- | ---------------- | ---------------------- |
| 2026-01-01 09:00       | 2026-01-01 00:00 | `2026-01-01T00:00:00Z` |
| 2026-01-01 18:00       | 2026-01-01 09:00 | `2026-01-01T09:00:00Z` |
| 2026-12-31 23:59       | 2026-12-31 14:59 | `2026-12-31T14:59:59Z` |

**ë³€í™˜ ê³µì‹**: UTC ì‹œê°„ = í•œêµ­ ì‹œê°„ - 9ì‹œê°„

**ì˜¨ë¼ì¸ ë„êµ¬**: [https://www.timeanddate.com/worldclock/converter.html](https://www.timeanddate.com/worldclock/converter.html)

#### 6. ë§¤ì¼ ë°˜ë³µë˜ëŠ” ì—…ë¬´ ì‹œê°„ ì œí•œ (ëŒ€ì•ˆ ì†”ë£¨ì…˜)

**ë¬¸ì œ**: AWS IAM ì •ì±…ë§Œìœ¼ë¡œëŠ” "ë§¤ì¼ 09:00-18:00"ì„ êµ¬í˜„í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.

**ëŒ€ì•ˆ 1: AWS Lambda + Amazon EventBridge**

```python
# Lambda í•¨ìˆ˜ë¡œ ë§¤ì¼ 09:00ì— ì •ì±… ì—°ê²°, 18:00ì— ì •ì±… ë¶„ë¦¬
import boto3

def lambda_handler(event, context):
    iam = boto3.client('iam')
    action = event['action']  # 'attach' or 'detach'

    if action == 'attach':
        iam.attach_user_policy(
            UserName='employee-user',
            PolicyArn='arn:aws:iam::123456789012:policy/WorkHoursPolicy'
        )
    elif action == 'detach':
        iam.detach_user_policy(
            UserName='employee-user',
            PolicyArn='arn:aws:iam::123456789012:policy/WorkHoursPolicy'
        )
```

**EventBridge ê·œì¹™**:

- 09:00 KST (00:00 UTC): Lambda í•¨ìˆ˜ í˜¸ì¶œ (action=attach)
- 18:00 KST (09:00 UTC): Lambda í•¨ìˆ˜ í˜¸ì¶œ (action=detach)

**ëŒ€ì•ˆ 2: AWS Config ê·œì¹™**

- AWS Configë¡œ ì—…ë¬´ ì‹œê°„ ì™¸ API í˜¸ì¶œì„ ê°ì§€í•˜ê³  ì•Œë¦¼
- ì‹¤ì‹œê°„ ì°¨ë‹¨ì€ ë¶ˆê°€ëŠ¥í•˜ì§€ë§Œ, ì‚¬í›„ ê°ì‚¬ ë° ê²½ê³  ê°€ëŠ¥

**ëŒ€ì•ˆ 3: ì„œë“œíŒŒí‹° ì†”ë£¨ì…˜**

- HashiCorp Vault: ì‹œê°„ ê¸°ë°˜ ë™ì  ìê²©ì¦ëª… ë°œê¸‰
- AWS IAM Identity Center: ì„¸ì…˜ ì‹œê°„ ì œí•œ ì„¤ì •

#### 7. ì‹œê°„ ê¸°ë°˜ ì •ì±… ëª¨ë²” ì‚¬ë¡€

**1. ì—¬ìœ  ì‹œê°„ í™•ë³´**

- ì‹œì‘ ì‹œê°„: ì‹¤ì œ í•„ìš” ì‹œê°„ë³´ë‹¤ 1-2ì‹œê°„ ì¼ì° ì„¤ì •
- ì¢…ë£Œ ì‹œê°„: ì‹¤ì œ í•„ìš” ì‹œê°„ë³´ë‹¤ 1-2ì‹œê°„ ëŠ¦ê²Œ ì„¤ì •
- ì´ìœ : ì‹œê°„ëŒ€ ë³€í™˜ ì˜¤ë¥˜, ì—…ë¬´ ì§€ì—° ë“±ì„ ê³ ë ¤

**2. ëª…ì‹œì  Deny ì‚¬ìš©**

- Allowë§Œ ì‚¬ìš©í•˜ë©´ ë‹¤ë¥¸ ì •ì±…ì˜ Allowê°€ ìš°ì„ ë  ìˆ˜ ìˆìŒ
- Denyë¥¼ í•¨ê»˜ ì‚¬ìš©í•˜ì—¬ ê¸°ê°„ ì™¸ ì ‘ê·¼ì„ í™•ì‹¤íˆ ì°¨ë‹¨

**3. ì•Œë¦¼ ì„¤ì •**

- Amazon CloudWatch Eventsë¡œ ì •ì±… ë§Œë£Œ 7ì¼ ì „ ì•Œë¦¼
- AWS Lambdaë¡œ ìë™ ì—°ì¥ ë˜ëŠ” ê´€ë¦¬ì ìŠ¹ì¸ ì›Œí¬í”Œë¡œìš° êµ¬í˜„

**4. í…ŒìŠ¤íŠ¸**

- ì •ì±… ì ìš© ì „ í…ŒìŠ¤íŠ¸ ì‚¬ìš©ìë¡œ ì¶©ë¶„íˆ í…ŒìŠ¤íŠ¸
- ì‹œê°„ëŒ€ ë³€í™˜ì´ ì˜¬ë°”ë¥¸ì§€ í™•ì¸
- ê¸°ê°„ ì‹œì‘/ì¢…ë£Œ ì‹œì ì— ì‹¤ì œ ë™ì‘ í™•ì¸

**5. ë¬¸ì„œí™”**

- ì •ì±… Descriptionì— ê¸°ê°„ ë° ëª©ì  ëª…ì‹œ
- íƒœê·¸ë¡œ ë§Œë£Œì¼ í‘œì‹œ (ì˜ˆ: `ExpiryDate=2026-12-31`)
- ì •ì±… ê²€í†  ì£¼ê¸° ì„¤ì • (ì›” 1íšŒ ê¶Œì¥)
