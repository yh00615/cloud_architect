# Week 6-3: CloudFormation λ³€κ²½ μ„ΈνΈ μ‹¤μµ νμΌ

μ΄ ν΄λ”μ—λ” CloudFormation λ³€κ²½ μ„ΈνΈ μƒμ„± λ° μ μ© μ‹¤μµμ— ν•„μ”ν• νμΌλ“¤μ΄ ν¬ν•¨λμ–΄ μμµλ‹λ‹¤.

## π“ ν¬ν•¨λ νμΌ

### 1. s3-bucket-versioning.yaml
**μ©λ„**: νƒμ¤ν¬ 2μ—μ„ μ‚¬μ©  
**μ„¤λ…**: S3 λ²„ν‚·μ— λ²„μ „ κ΄€λ¦¬μ™€ νƒκ·Έλ¥Ό μ¶”κ°€ν•λ” ν…ν”λ¦Ώ

**μ£Όμ” λ³€κ²½ μ‚¬ν•­**:
- λ²„μ „ κ΄€λ¦¬ ν™μ„±ν™” (VersioningConfiguration)
- νƒκ·Έ μ¶”κ°€ (Environment, Purpose)

**μ‚¬μ© μ‹μ **: λ³€κ²½ μ„ΈνΈλ¥Ό μƒμ„±ν•μ—¬ κΈ°μ΅΄ μ¤νƒμ„ μ•μ „ν•κ² μ—…λ°μ΄νΈν•  λ•

### 2. stack-policy.json
**μ©λ„**: νƒμ¤ν¬ 5μ—μ„ μ‚¬μ©  
**μ„¤λ…**: S3 λ²„ν‚·μ κµμ²΄μ™€ μ‚­μ λ¥Ό μ°¨λ‹¨ν•λ” μ¤νƒ μ •μ±…

**μ •μ±… λ‚΄μ©**:
- S3 λ²„ν‚·μ Replaceμ™€ Delete μ‘μ—… μ°¨λ‹¨
- λ‹¤λ¥Έ λ¨λ“  Update μ‘μ—…μ€ ν—μ©

**μ‚¬μ© μ‹μ **: μ¤‘μ”ν• λ¦¬μ†μ¤λ¥Ό μ‹¤μλ΅ μ‚­μ ν•κ±°λ‚ κµμ²΄ν•μ§€ μ•λ„λ΅ λ³΄νΈν•  λ•

### 3. s3-bucket-rename.yaml
**μ©λ„**: νƒμ¤ν¬ 5.3μ—μ„ μ‚¬μ©  
**μ„¤λ…**: λ²„ν‚· μ΄λ¦„μ„ λ³€κ²½ν•μ—¬ λ¦¬μ†μ¤ κµμ²΄λ¥Ό μ‹λ„ν•λ” ν…ν”λ¦Ώ (ν…μ¤νΈμ©)

**μ£Όμ” νΉμ§•**:
- BucketName μ†μ„± μ¶”κ°€ (λ¦¬μ†μ¤ κµμ²΄ λ°μƒ)
- μ¤νƒ μ •μ±…μ΄ μ΄λ¥Ό μ°¨λ‹¨ν•λ”μ§€ ν…μ¤νΈ

**μ‚¬μ© μ‹μ **: μ¤νƒ μ •μ±…μ΄ μ¬λ°”λ¥΄κ² μ‘λ™ν•λ”μ§€ κ²€μ¦ν•  λ•

## π― μ‹¤μµ νλ¦„

```
1. κΈ°λ³Έ μ¤νƒ μƒμ„±
   β””β”€ AWS μ κ³µ ν…ν”λ¦Ώ μ‚¬μ©

2. λ³€κ²½ μ„ΈνΈ μƒμ„±
   β””β”€ s3-bucket-versioning.yaml μ‚¬μ©
   β””β”€ λ³€κ²½ μ‚¬ν•­ κ²€ν† 

3. λ³€κ²½ μ„ΈνΈ μ‹¤ν–‰
   β””β”€ μ¤νƒ μ—…λ°μ΄νΈ

4. μ¤νƒ μ •μ±… μ μ©
   β””β”€ stack-policy.json μ‚¬μ©

5. μ¤νƒ μ •μ±… ν…μ¤νΈ
   β””β”€ s3-bucket-rename.yaml μ‚¬μ©
   β””β”€ κµμ²΄ μ°¨λ‹¨ ν™•μΈ

6. λ“λ¦¬ν”„νΈ κ°μ§€
   β””β”€ μλ™ λ³€κ²½ νƒμ§€
```

## π’΅ μ£Όμ” ν•™μµ ν¬μΈνΈ

### λ³€κ²½ μ„ΈνΈ (Change Set)
- μ¤νƒ μ—…λ°μ΄νΈ μ „ λ³€κ²½ μ‚¬ν•­μ„ λ―Έλ¦¬ ν™•μΈ
- λ¦¬μ†μ¤ κµμ²΄ μ—¬λ¶€ ν™•μΈ κ°€λ¥
- μ•μ „ν• ν”„λ΅λ•μ… λ°°ν¬

### μ¤νƒ μ •μ±… (Stack Policy)
- μ¤‘μ” λ¦¬μ†μ¤ λ³΄νΈ
- μ‹¤μλ΅ μΈν• μ‚­μ /κµμ²΄ λ°©μ§€
- ν• λ² μ„¤μ •ν•λ©΄ μ κ±° λ¶κ°€

### λ“λ¦¬ν”„νΈ κ°μ§€ (Drift Detection)
- ν…ν”λ¦Ώκ³Ό μ‹¤μ  λ¦¬μ†μ¤ λΉ„κµ
- μλ™ λ³€κ²½ νƒμ§€
- μΈν”„λΌ μΌκ΄€μ„± μ μ§€

## β οΈ μ£Όμμ‚¬ν•­

1. **μ¤νƒ μ •μ±… μ„¤μ • ν›„**:
   - μ¤νƒ μ •μ±…μ€ μ κ±°ν•  μ μ—†μµλ‹λ‹¤
   - λ” μ ν•μ μΈ μ •μ±…μΌλ΅λ§ μ—…λ°μ΄νΈ κ°€λ¥
   - μ‹ μ¤‘ν•κ² μ„¤μ •ν•μ„Έμ”

2. **λ¦¬μ†μ¤ κµμ²΄**:
   - Replacement: TrueμΈ κ²½μ° λ°μ΄ν„° μ†μ‹¤ κ°€λ¥
   - λ°λ“μ‹ λ³€κ²½ μ„ΈνΈλ΅ ν™•μΈ ν›„ μ‹¤ν–‰
   - λ°±μ—… ν•„μ

3. **λ“λ¦¬ν”„νΈ κ°μ§€**:
   - μλ™μΌλ΅ μμ •ν•μ§€ μ•μ
   - κ΄€λ¦¬μκ°€ μλ™μΌλ΅ μ²λ¦¬ ν•„μ”
   - μ •κΈ°μ μΌλ΅ ν™•μΈ κ¶μ¥

## π”— κ΄€λ ¨ AWS λ¬Έμ„

- [λ³€κ²½ μ„ΈνΈ μ‚¬μ©](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-changesets.html)
- [μ¤νƒ μ •μ±…](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/protect-stack-resources.html)
- [λ“λ¦¬ν”„νΈ κ°μ§€](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-stack-drift.html)

## π“ μ‹¤μµ κ°€μ΄λ“

μ „μ²΄ μ‹¤μµ κ°€μ΄λ“λ” λ‹¤μ μ„μΉμ—μ„ ν™•μΈν•  μ μμµλ‹λ‹¤:
`/content/week6/6-3-cloudformation-changeset.md`
